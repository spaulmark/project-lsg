{"version":3,"sources":["model/playerProfile.ts","model/powerRanking.ts","model/houseguest.ts","utils/utilities.ts","utils/relationshipMap.ts","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/selectedPortrait.ts","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/layout/text.ts","utils/ai/classifyRelationship.ts","components/pregameScreen/pregameScreen.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","subjects/subjects.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/viewsBar/viewBarTag.tsx","components/layout/box.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/scene.tsx","components/layout/centered.tsx","utils/ai/aiUtils.ts","utils/ai/aiApi.ts","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","model/logging/episodelog.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/sidebar/sidebarController.ts","components/episode/pregameEpisode.tsx","components/sidebar/sidebar.tsx","theme/theme.ts","components/topbar/themeSwitch.tsx","components/topbar/topBar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/globalTheme.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["PlayerProfile","init","Object","classCallCheck","this","name","imageURL","assign","PowerRanking","beats","outOf","Error","createClass","key","get","Houseguest","_PlayerProfile","_this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","popularity","deltaPopularity","relationships","powerRanking","superiors","Set","getFriendEnemyCount","friends","enemies","assertThisInitialized","inherits","value","villain","roundTwoDigits","number","Math","round","newRelationshipMap","size","exclude","result","i","componentToHex","c","hex","toString","length","Rgb","r","g","b","concat","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","getSelectedPlayer","undefined","state","displayMode","backgroundColor","_this2","push","selectedPlayer$","subscribe","next","displayMode$","forEach","sub","unsubscribe","has","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","isNullOrUndefined","player","subtitle","Img","imageClass","getImageClass","generateSubtitle","detailed","Portrait","react_default","a","createElement","onClick","style","src","height","width","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","p","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","memoryWallPortrait","MemoryWall","margin","maxWidth","NextEpisodeButton","switchSceneRelative","RelationshipType","HasText","text_templateObject","input","text_templateObject2","_ref2","PregameScreen","cast","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","addPopularityLine","hero","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","addCompsLine","compWins","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","x","xSquared","extremeValues","_addFriendshipCountTi","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","toFloat","_","mainContentStream$","BehaviorSubject","episodes$","switchEpisode$","Subject","newEpisode","episode","n","cast$","isFullscreen$","theme$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","slicedToArray","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","getById","gameState","houseguestCache","inclusions","exclusions","excludedIds","hg","filter","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","getJurors","inJury","remainingPlayers","finalJurySize","GameState","phase","previousHOH","log","Array","profiles","profile","objectSpread","MutableGameState","copy","cloneDeep","ViewBarTag","selected","mode","_this3","disabled","background","toRgba","cursor","ShadowBox","box_templateObject","overlay","StyledBox","box_templateObject2","_ref3","bodyArea","DividerBox","Box","ViewsBox","viewBar_templateObject","ViewsBar","viewBarTag_ViewBarTag","Episode","scenes","title","type","arrowsEnabled","viewsBar","hasViewsbar","Scene","render","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","favouriteIndex","callback","highestIndex","highestScore","Infinity","currentScore","lowestScore","lowestIndex","doesHeroWinTheFinale","hgs","jury","heroVotes","villainVotes","juror","heroShouldTargetSuperiors","totalPlayers","castEvictionVote","nominees","nom0","nom1","zeroIsInferior","oneIsInferior","cutthroatVote","nonVote","decision","reason","target","nonTarget","excuse","targetIsFriend","nonTargetIsNonFriend","nonTargetIsFriend","targetIsNonFriend","cutthroatVoteJury","r0","r1","vote","nominateNPlayers","hitlist","hitList","trueOptions","useGoldenVetoPreJury","save","rel0","relationshipWith","rel1","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","getValue","EndgameTableCell","td","votingTable_templateObject","tableCellBorder","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","grayCell","White","votingTable_templateObject4","_ref4","lightGrayCell","votingTable_templateObject5","_ref5","evictedCell","WinnerCell","votingTable_templateObject6","_ref6","winnerCell","RunnerUpCell","votingTable_templateObject7","_ref7","runnerUpCell","NomineeCell","_templateObject8","_ref8","nomineeCell","HohCell","_templateObject9","_ref9","hohCell","BlackRow","tr","_templateObject10","generateVotingTable","masterLog","houseguestCells","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","cells","colSpan","generateTopRow","nominationsPreVeto","rowSpan","generatePreVetoRow","vetoWinner","generateVetoRow","nominationsPostVeto","generatePostVetoRow","voteTextLine1","soleVoter","votesInMajority","votingTable_Evicted","evicted","generateEvictedRow","runnerUp","winner","_arr","entries","votes","_i","_ref12","_ref11","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","evictionColSpan","weeks","reverse","weekText","tempList","slice","voteKey","getKey","NormalVote","NomineeVote","HoHVote","hohText","hohVote","juryVoteScene","initialGameState","newGameState","jurors","finalists","castJuryVote","currentLog","votesFor0","votesFor1","voteCountText","scene","BigBrotherFinale","canPlayWith","eliminates","generateBbFinale","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","portraits_Portrait","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","HoH","_castEvictionVote","evictee","survivor","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","BigBrotherFinaleEpisode","_Episode","GameOver","GameOverEpisode","EpisodeLog","EpisodeFactory","episodeType","newState","iMap","j","jMap","impression","randomFloat","firstImpressions","heroWinsTheFinale","add","populateSuperiors","house","sum","targetId","calculatePopularity","updatePopularity","rel","updateFriendCounts","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","shuffle","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","vetoChoice","useGoldenVeto","replacementSpeech","nameAReplacement","finalNominees","toConsumableArray","replacementNom","replacementIndex","findIndex","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","lastVoter","logic","tieVote","tieBreaker","displayHoH","generateEvictionScene","_generateEvictionScen2","BigBrotherVanillaEpisode","generateBbVanilla","generateGameOver","delete","newCast","players","Season","factory","nextEpisode","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","newPlayerCount","nextEpisodeType","whichEpisodeType","renderEpisode","onNewEpisode","_switchToScene","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","index","stop","_x","apply","event","keyCode","_handleKeyDown","bind","PregameEpisodeType","PregameEpisode","Sidebar","document","addEventListener","handleKeyDown","destroy","minWidth","display","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","lightTheme","bg","toggleBorder","gradient","link","darkTheme","ThemeSwitcher","_useState","useState","window","matchMedia","matches","_useState2","setTheme","Topbar","marginTop","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","page","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","Boolean","location","hostname","match","ReactDOM","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.2c3bd2b0.chunk.js","sourcesContent":["export class PlayerProfile {\n    readonly name: string = \"\";\n    readonly imageURL: string = \"\";\n    constructor(init: PlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export class PowerRanking {\n    readonly beats: number;\n    readonly outOf: number;\n    get toFloat(): number {\n        return this.beats / this.outOf;\n    }\n\n    constructor(beats: number, outOf: number) {\n        if (outOf === 0) throw new Error(\"Power ranking attempted to divide by zero\");\n        this.beats = beats;\n        this.outOf = outOf;\n    }\n}\n","import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\nimport { PowerRanking } from \"./powerRanking\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    // power rankings range from 0 to 1\n    public powerRanking: PowerRanking = new PowerRanking(0, 1);\n    readonly superiors: Set<number> = new Set<number>();\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n\n    public getFriendEnemyCount: () => { friends: number; enemies: number } = () => {\n        return { friends: 0, enemies: 0 };\n    };\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: displayMode => this.view.setState({ displayMode })\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach(sub => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): PowerRanking {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return new PowerRanking(0, 1);\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors.has(id) ? new PowerRanking(1, 1) : new PowerRanking(0, 1);\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data)\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: new PowerRanking(2, 1) });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNullOrUndefined } from \"util\";\nimport { RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    max-width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: Set<number>;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNullOrUndefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNullOrUndefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: Set<number>;\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: ProfileHouseguest[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest) => {\n        let result;\n        if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest.tooltip) {\n            result = <Tooltip text={houseguest.tooltip}>{result}</Tooltip>;\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 700 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\"\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"\", ENEMY: \"\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { HasText } from \"../layout/text\";\n\ninterface PregameScreenProps {\n  cast: PlayerProfile[];\n}\n\nexport function PregameScreen(props: PregameScreenProps): JSX.Element {\n  if (props.cast.length === 0) {\n    return <HasText>Cast is empty.</HasText>;\n  }\n  return (\n    <HasText>\n      Welcome to Big Brother!\n      <MemoryWall houseguests={props.cast} />\n      <NextEpisodeButton />\n    </HasText>\n  );\n}\n","import React from \"react\";\nimport { roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`${state.powerRanking!.beats > 0 ? \"LOSE\" : \"WIN\"}`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WINS ${state.powerRanking.beats}/${state.powerRanking.outOf}`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | \" : \" | \";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? ` ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `| ${houseguest.povWins}`\n            : houseguest.povWins\n            ? ` ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? ` ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count = hero.getFriendEnemyCount ? hero.getFriendEnemyCount() : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]} | ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking.toFloat);\n    },\n    generateSubtitle: generatePowerSubtitle\n};\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme, lightTheme } from \"../theme/theme\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\nexport const theme$ = new Subject<ColorTheme>();\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: cast => {\n        let castNames = \"\";\n        cast.forEach(houseguest => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    }\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map(hg => hg.id);\n    return inclusions.filter(hg => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState) {\n    return gameState.houseguests.filter(hg => !hg.isEvicted);\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter(hg => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach(houseguest => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i)\n                });\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { EpisodeType, Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\nlet jurors = 7;\nconst sub = cast$.subscribe({\n    next: newCast => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    }\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    public renderEpisode(gameState: GameState, type: EpisodeType): Episode {\n        return this.factory.nextEpisode(gameState, type);\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import React from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { Box } from \"../layout/box\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ViewsBox = styled(Box)`\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nexport function ViewsBar() {\n    return (\n        <ViewsBox className=\"level is-mobile\" key=\"viewsbar\">\n            <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n            <ViewBarTag mode={powerMode} text={\"Power Rankings\"}></ViewBarTag>\n            <ViewBarTag mode={powerMode} disabled={true} text={\"Cliques [Coming Soon]\"}></ViewBarTag>\n        </ViewsBox>\n    );\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = <div>{`Error while rendering ${this.title}`}</div>;\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return <Center>{props.children} </Center>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import { Houseguest, inJury, GameState } from \"../../model\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the best relationship with.\n    return highestScore(hero, options, relationship);\n}\n\nexport function highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\nexport function doesHeroWinTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): boolean {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    let heroVotes = 0;\n    let villainVotes = 0;\n    jury.forEach(juror => {\n        if (juror.id === hero.id || juror.id === villain.id) {\n            return;\n        }\n        if (relationship(hero, juror) > relationship(villain, juror)) {\n            heroVotes++;\n        } else {\n            villainVotes++;\n        }\n    });\n    return heroVotes > villainVotes;\n}\n\nexport function heroShouldTargetSuperiors(hero: Houseguest, gameState: GameState): boolean {\n    const totalPlayers = gameState.remainingPlayers;\n    const superiors = hero.superiors.size;\n    // const inferiors = totalPlayers - 1 - hero.superiors.size;\n\n    // Old logic: Target the larger group. If they are equal, target superiors.\n    // return superiors >= inferiors;\n\n    // New logic: Target superiors unless you are in the top 25% of the playerlist.\n    return superiors / totalPlayers >= 0.25;\n}\n\n// TODO: this function can just honestly die. it's only used in nomination logic (which sucks anyways)\n// when I do the new logic, I think people who are dead center should target their superiors. works in F5.\n\nexport function hitList(hero: Houseguest, options: Houseguest[], gameState: GameState): Set<number> {\n    let result = options;\n    // jury logic is not affected by someone who is dead center in power rankings\n    if (inJury(gameState) && heroShouldTargetSuperiors(hero, gameState)) {\n        if (hero.superiors.size * 2 < gameState.remainingPlayers - 1) {\n            result = options.filter(hg => !hero.superiors.has(hg.id));\n        } else {\n            result = options.filter(hg => hero.superiors.has(hg.id));\n        }\n    } else {\n    }\n    return new Set(result.map(hg => hg.id));\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, inJury, exclude } from \"../../model\";\nimport { favouriteIndex, relationship, lowestScore, hitList, heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"./classifyRelationship\";\n\ninterface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const zeroIsInferior = !hero.superiors.has(nom0.id);\n    const oneIsInferior = !hero.superiors.has(nom1.id);\n    // if there is no sup/inf difference, no point in doing special logic for it\n    if (zeroIsInferior === oneIsInferior) {\n        return cutthroatVote(hero, nominees);\n    }\n    // Don't evict the last person in the game you can beat\n    if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && (zeroIsInferior || oneIsInferior)) {\n        const nonVote = zeroIsInferior ? 0 : 1;\n        return {\n            decision: zeroIsInferior ? 1 : 0,\n            reason: `I can't evict ${nominees[nonVote].name}, because they are the last person I can beat.`\n        };\n    }\n    const target = heroShouldTargetSuperiors(hero, gameState) === oneIsInferior ? 0 : 1;\n    const nonTarget = target ? 0 : 1;\n    const excuse = heroShouldTargetSuperiors(hero, gameState)\n        ? `I can't beat ${nominees[target].name} in the end.`\n        : `I need to keep ${nominees[nonTarget].name} around as a shield.`;\n    const targetIsFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[target].popularity,\n            hero.relationships[nominees[target].id]\n        ) === Relationship.Friend;\n    const nonTargetIsNonFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[nonTarget].popularity,\n            hero.relationships[nominees[nonTarget].id]\n        ) !== Relationship.Friend;\n    const nonTargetIsFriend = !nonTargetIsNonFriend;\n    const targetIsNonFriend = !targetIsFriend;\n    // the only reason to not evict your target is if he is your only friend on the block\n    if (targetIsFriend && nonTargetIsNonFriend) {\n        return { decision: nonTarget, reason: `${nominees[nonTarget].name} is my enemy.` };\n    } else if (targetIsFriend && nonTargetIsFriend) {\n        return { decision: target, reason: `Both noms are my friends, but ${excuse}` };\n    } else if (targetIsNonFriend && nonTargetIsNonFriend) {\n        return { decision: target, reason: `Neither of the noms are my friends, but ${excuse}` };\n    } else {\n        return { decision: target, reason: `${excuse}` };\n    }\n}\n\n// TODO: only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        return {\n            decision: nom0.popularity > nom1.popularity ? 0 : 1,\n            reason: \"Both noms are my enemies, so I voted for the more popular one.\"\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `Both noms are my friends. but I like ${nominees[vote === 0 ? 1 : 0].name} more.`\n    };\n}\n\n// TODO: target and pawn based nominations, different pre and post jury.\nexport function nominateNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const hitlist = hitList(hero, options, gameState);\n    let trueOptions = options.filter(hg => hitlist.has(hg.id));\n    if (trueOptions.length === 0) {\n        // if there are no options, we must sadly deviate from the hit list\n        trueOptions = options;\n    }\n    while (result.length < n) {\n        const decision = trueOptions[lowestScore(hero, trueOptions, relationship)];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n        trueOptions = exclude(trueOptions, [decision]);\n        if (trueOptions.length === 0) {\n            trueOptions = options.filter(hg => !hitlist.has(hg.id));\n        }\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let result: HouseguestWithLogic;\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        result = { decision: hero, reason: \"I am going to save myself.\" };\n    } else {\n        if (inJury(gameState)) {\n            // Note that I am currently not using the post-jury veto logic, primarily because it sucks at the moment\n            result = useGoldenVetoPreJury(hero, nominees);\n        } else {\n            result = useGoldenVetoPreJury(hero, nominees);\n        }\n        if (nonEvictedHouseguests(gameState).length === 4) {\n            result = {\n                decision: null,\n                reason: \"It doesn't make sense to use the veto here.\"\n            };\n        }\n    }\n    return result || null;\n}\n\n// works with any number of nominees\nfunction useGoldenVetoPostJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"No reason specified.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    // identify potential save targets\n    nominees.forEach((nominee: Houseguest) => {\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationships[nominee.id]\n        );\n        const shouldTargetSuperiors = heroShouldTargetSuperiors(hero, gameState);\n        const nomineeIsSuperior: boolean = hero.superiors.has(nominee.id);\n        // always save the last person you can beat\n        if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && !nomineeIsSuperior) {\n            alwaysSave = nominee;\n            reason = `I have to save ${nominee.name}, because they are the last person I can beat.`;\n        }\n        // must be a friend and a non-target\n        // TODO: some people have the entire game as targets. they shouldn't be affected. --------------------------\n        if (relationship === Relationship.Friend && nomineeIsSuperior !== shouldTargetSuperiors) {\n            const excuse = heroShouldTargetSuperiors(hero, gameState)\n                ? `I can beat them in the end.`\n                : `I need to keep them around as a shield.`;\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n            } else {\n                reason = `${nominee.name} is my friend, and ${excuse} `;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason: \"Not sure what to put here yet.\" };\n    }\n}\n\nfunction useGoldenVetoPreJury(hero: Houseguest, nominees: Houseguest[]): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"Neither of these nominees are my friends.\";\n    const rel0 = classifyRelationship(\n        hero.popularity,\n        nominees[0].popularity,\n        hero.relationshipWith(nominees[0])\n    );\n    const rel1 = classifyRelationship(\n        hero.popularity,\n        nominees[1].popularity,\n        hero.relationshipWith(nominees[1])\n    );\n    // basic logic that only saves friends. Doesn't take into account jury stuff.\n    if (rel0 === Relationship.Friend && rel1 !== Relationship.Friend) {\n        save = 0;\n        reason = `${nominees[0].name} is my friend.`;\n    } else if (rel1 === Relationship.Friend && rel0 !== Relationship.Friend) {\n        save = 1;\n        reason = `${nominees[1].name} is my friend.`;\n    } else if (rel0 === Relationship.Friend && rel1 === Relationship.Friend) {\n        save = Math.max(nominees[0].popularity, nominees[1].popularity) === nominees[0].popularity ? 0 : 1;\n        reason = `Both nominees are my friends, but I like ${nominees[save].name} more.`;\n    }\n    return { decision: nominees[save], reason };\n}\n\n// Returns the index of the finalist with the highest relationship with juror\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    return favouriteIndex(juror, finalists);\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: number[] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((log, i) => {\n        generateTopRow(log, i, topRowCells, masterLog.length - 1);\n        generatePreVetoRow(log, i, preVetoCells);\n        generateVetoRow(log, i, vetoCells);\n        generatePostVetoRow(log, i, postVetoCells);\n        generateEvictedRow(log, i, evictedCells, gameState);\n        if (!log) return;\n        evictionOrder.push(log.evicted);\n        if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n        if (log.winner !== undefined) evictionOrder.push(log.winner);\n        // add each of the votes to the houseguest cells\n        for (const [key, value] of Object.entries(log.votes)) {\n            // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n            const id: number = (key as unknown) as number;\n            const vote: VoteType = value;\n            houseguestCells[id].push(vote.render(gameState));\n        }\n        if (log.winner !== undefined && log.runnerUp !== undefined) {\n            houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n            houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n            evictedCells.push(\n                <RunnerUpCell>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Finalist</small> {/** TODO: put \"X votes\" here instead. */}\n                    </Centered>\n                </RunnerUpCell>\n            );\n            winnerCells.push(\n                <WinnerCell>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Winner</small>\n                    </Centered>\n                </WinnerCell>\n            );\n        }\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let evictionColSpan = -1;\n    const weeks = evictionOrder.length;\n    evictionOrder.reverse().forEach((id, i) => {\n        if (evictionColSpan > 0) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n            const isJury = getById(gameState, id).isJury;\n            const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n            const evicted = (\n                <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n        evictionColSpan++;\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={i} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n\n    const voteTextLine1 =\n        log.soleVoter !== undefined\n            ? `${log.soleVoter}'s choice`\n            : `${log.votesInMajority} of ${log.outOf} votes`;\n\n    cells.push(\n        <Evicted key={i} rowSpan={2}>\n            <Centered noMargin={true}>\n                <b>{getById(gameState, log.evicted).name}</b>\n                <br />\n                <small>\n                    {voteTextLine1} <br />\n                    to evict\n                </small>\n            </Centered>\n        </Evicted>\n    );\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`postVeto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPostVeto[0]}\n                <br /> {log.nominationsPostVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0) {\n        cells.push(\n            <White key={`preveto--${i}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPreVeto[0]}\n                <br /> {log.nominationsPreVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[], max: number) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach(juror => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nexport function generateBbFinale(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            Finale Night\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                    <Portrait houseguest={hoh} centered={true} />\n                    <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                    <Portraits houseguests={nominees} centered={true} />\n                    <Centered>\n                        It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                        House.\n                    </Centered>\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinale } from \"./bigBrotherFinale\";\nimport { rng, roundTwoDigits } from \"../../utils\";\nimport { doesHeroWinTheFinale as heroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport { GameOver, generateGameOver } from \"./gameOver\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of 100% random mutual relationships\n            const jMap = houseguests[j].relationships;\n            const impression = rng().randomFloat();\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            if (heroWinsTheFinale({ hero, villain }, houseguests)) {\n                villain.superiors.add(hero.id);\n            } else {\n                hero.superiors.add(villain.id);\n            }\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach(hg => {\n        hg.powerRanking = new PowerRanking(\n            houseguests.length - 1 - hg.superiors.size,\n            houseguests.length - 1\n        );\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach(hg => {\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach(hero => {\n        hero.getFriendEnemyCount = () => {\n            let friends = 0;\n            let enemies = 0;\n            houseguests.forEach(villain => {\n                const rel = classifyRelationship(\n                    hero.popularity,\n                    villain.popularity,\n                    hero.relationshipWith(villain)\n                );\n                if (hero.id === villain.id) {\n                    return;\n                } else if (rel === Relationship.Friend) {\n                    friends++;\n                } else if (rel === Relationship.Enemy) {\n                    enemies++;\n                }\n            });\n            return { friends, enemies };\n        };\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        newState.phase++;\n        if (nonEvictedHouseguests(gameState).length > 2) {\n            newState.log[newState.phase] = new EpisodeLog();\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        updateFriendCounts(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinale(finalState);\n            case GameOver:\n                return generateGameOver(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode,\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    if (inJury(gameState)) {\n        nonEvictedHouseguests(gameState).forEach((hg) => {\n            hg.superiors.delete(evictee.id);\n        });\n    }\n    gameState.remainingPlayers--;\n}\n\nexport function generateBbVanilla(initialGameState: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner\n    );\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <HasText>\n            {`Week ${currentGameState.phase}`}\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({ title, scenes, content, gameState, type: BigBrotherVanilla });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n\n    newHoH.hohWins += 1;\n\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {previousHoh.length > 0 &&\n                        `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete. `}\n                </Centered>\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    exclude,\n    nonEvictedHouseguests,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const options = exclude(nonEvictedHouseguests(newGameState), [HoH]);\n    const nom1 = getById(newGameState, nominateNPlayers(HoH, options, newGameState, 2)[0].decision);\n    const nom2 = getById(\n        newGameState,\n        nominateNPlayers(HoH, exclude(options, [nom1]), newGameState, 2)[1].decision\n    );\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate two houseguests for eviction.\n                </Centered>\n                <Portrait centered={true} houseguest={HoH} />\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>{`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        // TODO: houseguests choice picks\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${nom2.name} as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>It's time to pick players for the veto competition.</Centered>\n                <Portraits centered={true} houseguests={[HoH, nom1, nom2]} />\n                <Centered>{introText}</Centered>\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the Golden Power of Veto!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState);\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        nameAReplacement += ` ${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                nominateNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner\n                    ]),\n                    initialGameState,\n                    1\n                )[0].decision\n            )\n        };\n        const replacementIndex = initialNominees.findIndex(hg => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>This is the Veto Ceremony.</Centered>\n                <Centered>\n                    {`${initialNominees[0].name} and ${initialNominees[1].name} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[1]} />\n                    </DividerBox>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    initialGameState.currentLog.nominationsPostVeto = [finalNominees[0].name, finalNominees[1].name];\n    return [initialGameState, scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    let lastVoter: Houseguest;\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] = new NormalVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    newGameState.currentLog.outOf = votesFor0 + votesFor1;\n    if (votesFor0 + votesFor1 === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { decision: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[tieBreaker.decision].id);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n        newGameState.currentLog.votesInMajority = votesFor0;\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n        newGameState.currentLog.votesInMajority = votesFor1;\n    } else {\n        evictee = nominees[tieBreaker.decision];\n        newGameState.currentLog.votesInMajority = votesFor1 + 1;\n    }\n    newGameState.currentLog.votes[nominees[0].id] = new NomineeVote(evictee.id === nominees[0].id);\n    newGameState.currentLog.votes[nominees[1].id] = new NomineeVote(evictee.id !== nominees[0].id);\n\n    evictHouseguest(newGameState, evictee.id);\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${HoH.name}, as current Head of Household, you must cast the sole vote to evict.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>I vote to evict {`${evictee.name}.`}</CenteredBold>\n                    </div>\n                )}\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <CenteredBold>{`${evictee.name}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$\n} from \"../../subjects/subjects\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: episode => this.onNewEpisode(episode)\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                }\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => (this.season = new Season())\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            const nextEpisodeType = this.season.whichEpisodeType(newPlayerCount);\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState, nextEpisodeType));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach(scene => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\ninterface SidebarState {\n  episodes: Episode[];\n  selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n  private controller: SidebarController;\n  public constructor(props: {}) {\n    super(props);\n    this.controller = new SidebarController(this);\n    this.state = { episodes: [], selectedScene: 0 };\n    newEpisode(new PregameEpisode(new GameState([])));\n  }\n\n  public componentDidMount() {\n    document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n  }\n\n  public componentWillUnmount() {\n    this.controller.destroy();\n  }\n\n  public render() {\n    return (\n      <Box style={{ minWidth: 180, display: \"none\" }}>\n        <HasText>{this.getEpisodes()}</HasText>\n      </Box>\n    );\n  }\n\n  private getHighlight(title: string, key: number) {\n    if (key === this.state.selectedScene) {\n      return <mark>{title}</mark>;\n    }\n    return title;\n  }\n\n  private getEpisodes() {\n    const result: JSX.Element[] = [];\n    // Weird OBOE to make keys start at 0\n    let episodeKey = -1;\n    let breakKey = 0;\n    this.state.episodes.forEach((episode: Episode) => {\n      const id = ++episodeKey;\n      result.push(\n        <b\n          key={id}\n          onClick={() => {\n            this.controller.switchToScene(id);\n          }}\n        >\n          {this.getHighlight(episode.title, id)}\n        </b>\n      );\n      result.push(<br key={--breakKey} />);\n      episode.scenes.forEach((scene: Scene) => {\n        const id = ++episodeKey;\n        if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n          result.push(\n            <a key={id} onClick={() => this.controller.switchToScene(id)}>\n              {this.getHighlight(scene.title, id)}\n            </a>\n          );\n          result.push(<br key={--breakKey} />);\n        }\n      });\n    });\n    return result;\n  }\n}\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    gradient: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\nexport const lightTheme: ColorTheme = {\n    name: \"light\",\n    bg: \"#fff\",\n    text: \"#363537\",\n    toggleBorder: \"#FFF\",\n    gradient: \"linear-gradient(#39598A, #79D7ED)\",\n    bodyArea: \"#fff\",\n    link: \"blue\",\n    mark: \"yellow\",\n    overlay: \"fff\",\n    evictedCell: \"#fa8072\",\n    grayCell: \"#eaecf0\",\n    lightGrayCell: \"#f8f9fa\",\n    winnerCell: \"#73fb76\",\n    runnerUpCell: \"#d1e8ef\",\n    nomineeCell: \"#959ffd\",\n    hohCell: \"#CCFFCC\",\n    portraitBorder: \"gray\",\n    tableCellBorder: \"#a2a9b1\",\n};\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    gradient: \"linear-gradient(#091236, #1E215D)\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import React, { useState } from \"react\";\nimport { theme$ } from \"../../subjects/subjects\";\nimport { darkTheme, lightTheme } from \"../../theme/theme\";\n\nexport function ThemeSwitcher() {\n    const [theme, setTheme] = useState(\n        window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\"\n    );\n    const toggleTheme = () => {\n        if (theme === \"light\") {\n            setTheme(\"dark\");\n            theme$.next(darkTheme);\n        } else {\n            setTheme(\"light\");\n            theme$.next(lightTheme);\n        }\n    };\n\n    const className = `button ${theme === \"dark\" ? `is-dark` : \"is-light\"}`;\n    return (\n        <div className={className} onClick={toggleTheme}>\n            {theme === \"light\" ? \"Dark mode\" : \"Light mode\"}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { ThemeSwitcher } from \"./themeSwitch\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\n\nexport function Topbar(props: { style?: any }): JSX.Element {\n  const style = { ...{ marginTop: 30 }, ...(props.style || {}) };\n  return (\n    <Box className=\"level is-mobile\" style={style}>\n      <HasText className=\"level-item\">\n        TODO: Enter Code: <input className=\"input\" />\n      </HasText>\n      <div className=\"level-item\">\n        <ThemeSwitcher />\n      </div>\n    </Box>\n  );\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n  controller: MainPageController;\n}\n\ninterface MainPageState {\n  fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n  public constructor(props: MainPageProps) {\n    super(props);\n    this.state = { fullscreen: false };\n    props.controller.inject(this);\n  }\n  public componentDidMount() {\n    this.props.controller.subscribe();\n  }\n  public componentWillUnmount() {\n    this.props.controller.unsubscribe();\n  }\n\n  public render() {\n    const fullscreen = this.state.fullscreen;\n    const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n    const wrapperStyle = fullscreen\n      ? { margin: \"auto\" }\n      : { margin: \"auto\", maxWidth: 1380, overflow: \"hidden\" };\n    return (\n      <div style={wrapperStyle}>\n        <Sidebar />\n        <Topbar style={hideOnFullscreen} />\n        <div className=\"columns\">\n          <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n            <MainContentArea />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n  div {\n    transition: all 0.25s linear;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { lightTheme, ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n  private sub: Subscription | null = null;\n  public constructor(props: any) {\n    super(props);\n    this.state = {\n      theme:\n        window.matchMedia &&\n        window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n          ? darkTheme\n          : lightTheme,\n    };\n  }\n\n  public componentDidMount() {\n    this.sub = theme$.subscribe((theme) => {\n      this.setState({ theme });\n    });\n  }\n\n  public componentWillUnmount() {\n    if (this.sub) this.sub.unsubscribe();\n  }\n\n  render() {\n    return (\n      <ThemeProvider theme={this.state.theme}>\n        <>\n          <GlobalStyles />\n          <MainPage controller={new MainPageController()} />\n        </>\n      </ThemeProvider>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {});\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {});\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {});\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}