{"version":3,"sources":["images/src sync nonrecursive /.jpg","images/src/Ancient Oven.jpg","images/src/Chio.jpg","images/src/Epona.jpg","images/src/Hunnie.jpg","images/src/Karson.jpg","images/src/Kass.jpg","images/src/Link.jpg","images/src/Magda.jpg","images/src/Master Kohga.jpg","images/src/Mipha.jpg","images/src/Oaki.jpg","images/src/Patrica.jpg","images/src/Pelison.jpg","images/src/Prince Sidon.jpg","images/src/Revali.jpg","images/src/Riju.jpg","images/src/Robbie.jpg","images/src/Roscoe.jpg","images/src/Royal White Horse.jpg","images/src/Teebo.jpg","images/src/Urbosa.jpg","utils/utilities.ts","utils/relationshipMap.ts","model/color.ts","utils/ai/classifyRelationship.ts","images/tribe.ts","utils/likeMap.ts","images/RelationshipMapper.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/selectedPortrait.ts","components/layout/box.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/tribeContainer.tsx","components/memoryWall/selectedTribe.ts","components/memoryWall/memoryWall.tsx","components/layout/text.ts","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/memoryWallScreen/memoryWallScreen.tsx","subjects/subjects.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/logging/episodelog.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/bigBrotherFinale.tsx","components/layout/centered.tsx","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","components/episode/gameOver.tsx","model/season.ts","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","utils/base64.ts","images/decoder.ts","components/topbar/topBarController.ts","images/encoder.ts","images/initialProfiles.ts","components/topbar/topBar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/theme.ts","theme/globalTheme.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["map","./Ancient Oven.jpg","./Chio.jpg","./Epona.jpg","./Hunnie.jpg","./Karson.jpg","./Kass.jpg","./Link.jpg","./Magda.jpg","./Master Kohga.jpg","./Mipha.jpg","./Oaki.jpg","./Patrica.jpg","./Pelison.jpg","./Prince Sidon.jpg","./Revali.jpg","./Riju.jpg","./Robbie.jpg","./Roscoe.jpg","./Royal White Horse.jpg","./Teebo.jpg","./Urbosa.jpg","webpackContext","req","id","webpackContextResolve","__webpack_require__","e","Error","code","keys","Object","resolve","module","exports","p","roundTwoDigits","number","Math","round","newDiscreteRelationshipMap","size","exclude","result","i","undefined","componentToHex","c","hex","toString","length","RelationshipType","ThreatLevel","Rgb","r","g","b","classCallCheck","this","createClass","key","value","concat","interpolateColor","min","max","percent","toHex","RelationshipTypeToSymbol","NEUTRAL","FRIEND","ENEMY","PAWN","QUEEN","HUNTER","TARGET","DUPE","DECEIVER","ThreatLevelToSymbol","THREAT","WEAK","RelationshipTypeToPopularity","ClassifyDiscreteRelationship","true","Friend","false","Dupe","Pawn","Deceiver","Enemy","Hunter","Queen","Target","Neutral","f","a","classifyRelationship","heroPopularity","villainPopularity","heroRelationship","villainRelationship","benefitsHero","benefitsVillain","tribeId","t","name","color","nullTribe","sizeOf","l","calculatePopularity","hg","n","likedBy","dislikedBy","calculatePowerRanking","thinksImThreat","thinksImWeak","threats","weaks","twoN","calcPowerRank","RelationshipMapper","houseguests","_this","cache","tribeIDs","Set","nonEvictedIDs","forEach","toUpperCase","isEvicted","push","get","_this2","dropYourBuffs","evict","unevict","hero","h","v","tribe","popularity","powerRanking","_this3","myTribeId","flag","toDelete","indexOf","neutral","utr","splice","groups","newR","likeKey","dislikeKey","hToV","getRelationship","villain","disabled","addToLikeMap","deleteFromLikeMap","updatePopularities","nonEvictedHouseguests","skeleton","members","_this4","filter","includes","has","add","setRelationship","like","j","friends","dislike","selectedColor","HouseguestPortraitController","view","subs","refreshTribeFilter","selectedTribe","selectedPlayer","getSelectedPlayer","updateLikeCounts","props","selectedPlayer$","next","refreshData","data","state","setState","getPopularity","relationships","getPowerRanking","powerRankings","goToDefaultState","displayMode","backgroundColor","subscribe","selectedTribe$","displayMode$","sub","unsubscribe","newState","hasSameTribe","_","objectSpread","defaultState","isNullOrUndefined","relationshipType","x","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","possibleConstructorReturn","getPrototypeOf","call","controller","assertThisInitialized","inherits","player","superiors","subtitle","Img","imageClass","getImageClass","generateSubtitle","detailed","Portrait","react_default","createElement","onClick","style","src","imageURL","height","React","Component","ShadowBox","box_templateObject","_ref2","overlay","StyledBox","box_templateObject2","_ref3","bodyArea","DividerBox","className","children","Box","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","assign","Text","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","Portraits","rows","memoryWallPortrait","tooltip","tooltip_Tooltip","centered","TribeContainer","getHoverable","normal","hilite","bg","charAt","substring","parseInt","col","pow","textColor","selected","tribeContainer_templateObject","Hoverable","tribeName","textAlign","select","bind","hgs","MemoryWall","houseguestsByTribe","groupBy","tribes","tribeContainer_TribeContainer","margin","maxWidth","HasText","text_templateObject","input","text_templateObject2","emptySubtitle","addCompsLine","compWins","lineHeight","hohWins","povWins","nominations","friendOrEnemyTitle","titles","threatLevelCountTitle","count","enemies","friendCountText","Threat","enemyCountText","Weak","friendEnemyCountTitle","Relationship","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","xSquared","extremeValues","arguments","_addCountTitle","discreteTitle","countTitle","txt","addCountTitle","powerMinColor","powerMaxColor","powerMode","statePopularity","deltaPop","deltaPopularity","arrow","addPopularityLine","ViewBarTag","mode","background","toRgba","cursor","ViewsBox","viewBar_templateObject","ViewsBar","viewBarTag_ViewBarTag","MemoryWallScreen","cast","players$","mainContentStream$","BehaviorSubject","memoryWallScreen_MemoryWallScreen","episodes$","switchEpisode$","Subject","switchSceneRelative","cast$","isFullscreen$","theme$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","slicedToArray","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","getById","gameState","houseguestCache","MutableGameState","init","remainingPlayers","phase","previousHOH","log","copy","cloneDeep","EpisodeLog","nominationsPreVeto","vetoWinner","winner","runnerUp","nominationsPostVeto","evicted","votes","votesInMajority","outOf","soleVoter","EpisodeFactory","episodeType","BigBrotherVanilla","canPlayWith","eliminates","arrowsEnabled","hasViewsbar","BigBrotherFinale","centered_templateObject","centered_templateObject2","fullscreenButton_templateObject","EndgameTableCell","td","votingTable_templateObject","tableCellBorder","table","votingTable_templateObject2","votingTable_templateObject3","grayCell","votingTable_templateObject4","_ref4","lightGrayCell","votingTable_templateObject5","_ref5","evictedCell","votingTable_templateObject6","_ref6","winnerCell","votingTable_templateObject7","_ref7","runnerUpCell","_templateObject8","_ref8","nomineeCell","_templateObject9","_ref9","hohCell","tr","_templateObject10","GameOver","Season","factory","type","nextEpisode","players","SidebarController","subscriptions","season","scenes","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","episode","lastEpisode","episodes","switchToScene","currentGameState","newPlayerCount","nextEpisodeType","whichEpisodeType","renderEpisode","onNewEpisode","_switchToScene","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","scene","render","index","stop","_x","apply","event","keyCode","_handleKeyDown","Sidebar","document","addEventListener","handleKeyDown","destroy","minWidth","display","getEpisodes","title","episodeKey","breakKey","getHighlight","getSelectedEpisode","Base64","digits","split","digitsMap","Map","set","fromInt","int32","toInt","digitsStr","m","decodeToRelationshipMapper","c1","reset","trim","_c$split","_c$split2","evictees","codeToHouseguest","decodeEvictees","hash","slice","chex","test","tribemates","decodeTribes","decodedR","decodedP","decode","fromTernary","decodeRelationships","alert","s","padStart","ternaryToRelationship","entries","0","1","2","lookedUp","TopbarController","onSubmit","inputCode","newMap","rMapper","encode","encodeNumber","toTernary","encodeRelationshipMapper","rBuffer","pBuffer","validateBuffer","nextCharR","nextCharP","padEnd","encodeRelationships","encodedTribes","ids","encodeTribes","encodeEvictees","master_kohga","revali","teebo","kass","link","chio","roscoe","riju","magda","robbie","initialProfiles","context","profiles","evictedHouseguests","jurors","item","replace","toLowerCase","setupProfiles","threat","console","importAll","require","Topbar","handleChange","target","marginTop","onChange","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","window","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","sidebar_Sidebar","topBar_Topbar","overflowX","mainContentArea_MainContentArea","MainPageController","page","darkTheme","toggleBorder","gradient","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","Boolean","location","hostname","match","ReactDOM","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.af5293ea.chunk.js","sourcesContent":["var map = {\n\t\"./Ancient Oven.jpg\": 51,\n\t\"./Chio.jpg\": 52,\n\t\"./Epona.jpg\": 53,\n\t\"./Hunnie.jpg\": 54,\n\t\"./Karson.jpg\": 55,\n\t\"./Kass.jpg\": 56,\n\t\"./Link.jpg\": 57,\n\t\"./Magda.jpg\": 58,\n\t\"./Master Kohga.jpg\": 59,\n\t\"./Mipha.jpg\": 60,\n\t\"./Oaki.jpg\": 61,\n\t\"./Patrica.jpg\": 62,\n\t\"./Pelison.jpg\": 63,\n\t\"./Prince Sidon.jpg\": 64,\n\t\"./Revali.jpg\": 65,\n\t\"./Riju.jpg\": 66,\n\t\"./Robbie.jpg\": 67,\n\t\"./Roscoe.jpg\": 68,\n\t\"./Royal White Horse.jpg\": 69,\n\t\"./Teebo.jpg\": 70,\n\t\"./Urbosa.jpg\": 71\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 50;","module.exports = __webpack_public_path__ + \"static/media/Ancient Oven.6b817900.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Chio.8c7ec4dc.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Epona.8a166a7c.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Hunnie.464c64ff.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Karson.67d640a7.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Kass.5807e1c5.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Link.de86ae97.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Magda.17e0b3bf.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Master Kohga.24908791.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Mipha.4179b588.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Oaki.7d4ced3f.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Patrica.3a61eba1.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Pelison.15012c7a.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Prince Sidon.9b347270.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Revali.f00e41f4.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Riju.89aa9092.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Robbie.9c3f703b.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Roscoe.9b467e1a.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Royal White Horse.af65312d.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Teebo.fa3c27d3.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Urbosa.84fbf55c.jpg\";","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n","export interface RelationshipMap {\n  [id: number]: number;\n}\n\nexport interface DiscreteRelationshipMap {\n  [id: number]: boolean | undefined;\n}\n\nexport function newRelationshipMap(\n  size: number,\n  exclude: number\n): RelationshipMap {\n  const result: RelationshipMap = {};\n  for (let i = 0; i < size; i++) {\n    if (i !== exclude) result[i] = 0;\n  }\n  return result;\n}\n\nexport function newDiscreteRelationshipMap(\n  size: number,\n  exclude: number\n): DiscreteRelationshipMap {\n  const result: DiscreteRelationshipMap = {};\n  for (let i = 0; i < size; i++) {\n    if (i !== exclude) result[i] = undefined;\n  }\n  return result;\n}\n","function componentToHex(c: any) {\n  var hex = Math.round(c).toString(16);\n  return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n  public r: number;\n  public g: number;\n  public b: number;\n  public toHex() {\n    return (\n      \"#\" +\n      componentToHex(this.r) +\n      componentToHex(this.g) +\n      componentToHex(this.b)\n    );\n  }\n  public toRgba(): string {\n    return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n  }\n  constructor(r: number, g: number, b: number) {\n    this.r = r;\n    this.g = g;\n    this.b = b;\n  }\n}\nfunction hexToRgb(hex: string) {\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16),\n      }\n    : null;\n}\n\nexport function textColor(bg: string) {\n  var color = bg.charAt(0) === \"#\" ? bg.substring(1, 7) : bg;\n  var r = parseInt(color.substring(0, 2), 16); // hexToR\n  var g = parseInt(color.substring(2, 4), 16); // hexToG\n  var b = parseInt(color.substring(4, 6), 16); // hexToB\n  var uicolors = [r / 255, g / 255, b / 255];\n  var c = uicolors.map((col) => {\n    if (col <= 0.03928) {\n      return col / 12.92;\n    }\n    return Math.pow((col + 0.055) / 1.055, 2.4);\n  });\n  var L = 0.2126 * c[0] + 0.7152 * c[1] + 0.0722 * c[2];\n  return L > 0.179 ? \"#000000\" : \"#ffffff\";\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n  return new Rgb(\n    min.r + percent * (max.r - min.r),\n    min.g + percent * (max.g - min.g),\n    min.b + percent * (max.b - min.b)\n  ).toHex();\n}\n","export enum RelationshipType {\n  Neutral = \"NEUTRAL\",\n  Friend = \"FRIEND\",\n  Enemy = \"ENEMY\",\n  Pawn = \"PAWN\",\n  Queen = \"QUEEN\",\n  Hunter = \"HUNTER\",\n  Target = \"TARGET\",\n  Dupe = \"DUPE\",\n  Deceiver = \"DECEIVER\",\n}\n\nexport enum ThreatLevel {\n  Threat = \"THREAT\",\n  Weak = \"WEAK\",\n  Neutral = \"NEUTRAL\",\n}\n\nexport const RelationshipTypeToSymbol = {\n  NEUTRAL: \"-\",\n  FRIEND: \"♥\",\n  ENEMY: \"💔\",\n  PAWN: \"THEY ♥ ME\",\n  QUEEN: \"I ♥ THEM\",\n  HUNTER: \"THEY 💔 ME\",\n  TARGET: \"I 💔 THEM\",\n  DUPE: \"I 💔 THEM THEY ♥ ME\",\n  DECEIVER: \"I ♥ THEM THEY 💔 ME\",\n};\n\nexport const ThreatLevelToSymbol = {\n  THREAT: \"💢\",\n  WEAK: \"💤\",\n  NEUTRAL: \"-\",\n};\n\nexport const RelationshipTypeToPopularity = {\n  NEUTRAL: 0,\n  FRIEND: 1,\n  ENEMY: -1,\n  PAWN: 0.66,\n  QUEEN: 0.33,\n  HUNTER: -0.66,\n  TARGET: -0.33,\n  DUPE: 0.25,\n  DECEIVER: -0.25,\n};\n\nexport const ClassifyDiscreteRelationship: {\n  [id: string]: { [id: string]: RelationshipType };\n} = {\n  true: {\n    true: RelationshipType.Friend,\n    false: RelationshipType.Dupe,\n    undefined: RelationshipType.Pawn,\n  },\n  false: {\n    true: RelationshipType.Deceiver,\n    false: RelationshipType.Enemy,\n    undefined: RelationshipType.Hunter,\n  },\n  undefined: {\n    true: RelationshipType.Queen,\n    false: RelationshipType.Target,\n    undefined: RelationshipType.Neutral,\n  },\n};\n\nfunction f(a: boolean | undefined): \"true\" | \"false\" | \"undefined\" {\n  if (a === true) return \"true\";\n  else if (a === false) return \"false\";\n  else return \"undefined\";\n}\n\nexport function classifyRelationship(\n  heroPopularity: number,\n  villainPopularity: number,\n  heroRelationship: number | boolean | undefined,\n  villainRelationship: number | boolean | undefined\n): RelationshipType {\n  if (\n    typeof heroRelationship !== \"number\" &&\n    typeof villainRelationship !== \"number\"\n  ) {\n    return ClassifyDiscreteRelationship[f(heroRelationship)][\n      f(villainRelationship)\n    ];\n  }\n\n  const benefitsHero = heroRelationship! > heroPopularity;\n  const benefitsVillain = heroRelationship! > villainPopularity;\n  if (benefitsHero && benefitsVillain) {\n    return RelationshipType.Friend;\n  } else if (benefitsHero && !benefitsVillain) {\n    return RelationshipType.Pawn;\n  } else if (!benefitsHero && benefitsVillain) {\n    return RelationshipType.Queen;\n  }\n  return RelationshipType.Enemy;\n}\n","export interface Tribe {\n  name: string;\n  color: string;\n  size: number;\n}\n\nexport function tribeId(t: Tribe | undefined): string {\n  if (t === undefined) return \"\";\n  return `${t.name}${t.color}`;\n}\n\nexport const nullTribe: Tribe = { name: \"\", color: \"\", size: 0 };\n","export interface Likemap {\n  [id: number]: {\n    tribeId: string;\n    groups: Set<number>;\n  };\n}\n\nexport function sizeOf(l: Likemap) {\n  return Object.keys(l).length;\n}\n","import { ProfileHouseguest } from \"../components/memoryWall\";\nimport { Tribe, tribeId } from \"./tribe\";\nimport { PlayerProfile } from \"../model\";\nimport { DiscreteRelationshipMap } from \"../utils\";\nimport { Likemap, sizeOf } from \"../utils/likeMap\";\n\ntype Map = \"relationships\" | \"powerRankings\";\ntype LikeKey = \"likedBy\" | \"thinksImThreat\";\ntype DislikeKey = \"dislikedBy\" | \"thinksImWeak\";\n\nfunction calcPowerRank(threats: number, weaks: number, n: number) {\n  if (n === 0) return 0;\n  const twoN = 2 * n;\n  return 0.5 + threats / twoN - weaks / twoN;\n}\n\nexport function calculatePopularity(\n  hg: { likedBy: Likemap; dislikedBy: Likemap },\n  n: number\n): number | undefined {\n  if (n < 1) return undefined;\n  const likedBy = sizeOf(hg.likedBy);\n  const dislikedBy = sizeOf(hg.dislikedBy);\n  let result: number | undefined = 0;\n  result = (likedBy - dislikedBy) / n;\n  likedBy === 0 && dislikedBy === 0 && (result = undefined);\n  return result;\n}\n\nexport function calculatePowerRanking(\n  hg: { thinksImThreat: Likemap; thinksImWeak: Likemap },\n  n: number\n): number | undefined {\n  if (n < 1) return undefined;\n  const thinksImThreat = sizeOf(hg.thinksImThreat);\n  const thinksImWeak = sizeOf(hg.thinksImWeak);\n  let result: number | undefined = 0;\n  result = calcPowerRank(thinksImThreat, thinksImWeak, n);\n  thinksImThreat === 0 && thinksImWeak === 0 && (result = undefined);\n  return result;\n}\n\nexport interface RelationshipHouseguest extends PlayerProfile {\n  id: number;\n  isEvicted?: boolean;\n  disabled?: boolean;\n  tribe?: Tribe;\n  //\n  relationships: DiscreteRelationshipMap;\n  popularity?: number;\n  likedBy: Likemap;\n  dislikedBy: Likemap;\n  //\n  powerRankings: DiscreteRelationshipMap;\n  powerRanking?: number;\n  thinksImWeak: Likemap;\n  thinksImThreat: Likemap;\n  //\n  tooltip?: string;\n}\nexport class RelationshipMapper {\n  public houseguests: RelationshipHouseguest[] = [];\n  private cache: {\n    [id: string]: RelationshipHouseguest;\n  } = {};\n  private tribeIDs: Set<string> = new Set<string>();\n  get nonEvictedHouseguests(): number {\n    return this.nonEvictedIDs.length;\n  }\n  nonEvictedIDs: number[] = []; // this must be an ordered type to guarentee encoding/decoding works. don't use a set\n  public constructor(houseguests: RelationshipHouseguest[]) {\n    this.houseguests = houseguests;\n    if (houseguests.length > 4096) {\n      throw new Error(\"The max number of players is 4096.\");\n    }\n    houseguests.forEach((hg) => {\n      this.cache[hg.name.toUpperCase()] = hg;\n      !hg.isEvicted && this.nonEvictedIDs.push(hg.id);\n    });\n  }\n\n  public getById(id: number): RelationshipHouseguest {\n    if (this.houseguests[id] === undefined) throw Error(\"invalid id\");\n    return this.houseguests[id];\n  }\n\n  public reset() {\n    this.dropYourBuffs();\n    this.houseguests.forEach((hg) => {\n      this.evict(hg.name);\n      this.unevict(hg.name);\n    });\n  }\n\n  private get(hero: string): RelationshipHouseguest {\n    const result = this.cache[hero.toUpperCase()];\n    if (result === undefined) throw new Error(`bad name: ${hero}`);\n    return result;\n  }\n  private getRelationship(h: string, v: string, map: Map) {\n    return this.get(h)[map][this.get(v).id];\n  }\n\n  public dropYourBuffs() {\n    this.tribeIDs = new Set<string>();\n    this.houseguests.forEach((hg) => {\n      hg.tribe = undefined;\n    });\n  }\n\n  private updatePopularities(hg: ProfileHouseguest, n: number) {\n    hg.popularity = calculatePopularity(hg, n);\n    hg.powerRanking = calculatePowerRanking(hg, n);\n  }\n\n  public evict(h: string) {\n    const hero = this.get(h);\n    const myTribeId = tribeId(hero.tribe);\n    let flag = true;\n    const toDelete = this.nonEvictedIDs.indexOf(hero.id);\n    if (hero.isEvicted) return;\n    hero.isEvicted = true;\n    this.nonEvictedIDs.forEach((id) => {\n      this.neutral(h, this.houseguests[id].name);\n      this.neutral(this.houseguests[id].name, h);\n      this.utr(h, this.houseguests[id].name);\n      this.utr(this.houseguests[id].name, h);\n      const tribe = this.houseguests[id].tribe;\n      if (flag && tribe && tribeId(tribe) === myTribeId) {\n        tribe.size--;\n        flag = false;\n      }\n    });\n    this.nonEvictedIDs.splice(toDelete, 1);\n  }\n\n  public unevict(h: string) {\n    const hero = this.get(h);\n    if (!hero.isEvicted) return;\n    hero.isEvicted = false;\n    this.nonEvictedIDs.push(hero.id);\n  }\n\n  private addToLikeMap(l: Likemap, h: RelationshipHouseguest) {\n    l[h.id] = { tribeId: tribeId(h.tribe), groups: new Set<number>() };\n  }\n\n  private deleteFromLikeMap(l: Likemap, h: RelationshipHouseguest) {\n    delete l[h.id];\n  }\n\n  public setRelationship(\n    h: string,\n    v: string,\n    newR: boolean | undefined,\n    likeKey: LikeKey,\n    dislikeKey: DislikeKey,\n    map: Map\n  ) {\n    const hToV = this.getRelationship(h, v, map);\n    const hero = this.get(h);\n    const villain = this.get(v);\n    if (\n      hToV === newR ||\n      ((hero.isEvicted ||\n        hero.disabled ||\n        villain.disabled ||\n        villain.isEvicted) &&\n        newR !== undefined)\n    ) {\n      return;\n    }\n    if (hToV === undefined) {\n      this.addToLikeMap(villain[newR ? likeKey : dislikeKey], hero);\n    } else if (newR === undefined) {\n      this.deleteFromLikeMap(villain[hToV ? likeKey : dislikeKey], hero);\n    } else {\n      this.addToLikeMap(villain[newR ? likeKey : dislikeKey], hero);\n      this.deleteFromLikeMap(villain[newR ? dislikeKey : likeKey], hero);\n    }\n    // actually set it\n    hero[map][villain.id] = newR;\n    this.updatePopularities(villain, this.nonEvictedHouseguests - 1);\n  }\n  public tribe(skeleton: { name: string; color: string }, members: string[]) {\n    const tribe = {\n      size: members.filter((hg) => !this.get(hg).isEvicted).length, // only count non-evicted members\n      name: skeleton.name,\n      color: skeleton.color,\n    };\n    if (tribe.name.includes(\"#\") || tribe.name.includes(\"=\")) {\n      throw new Error(\"Tribe names cannot contain # or =\");\n    }\n    if (this.tribeIDs.has(tribeId(tribe))) {\n      throw new Error(`Tribe ${tribeId(tribe)} declared twice`);\n    }\n    this.tribeIDs.add(tribeId(tribe));\n    members.forEach((hg) => {\n      this.get(hg).tribe = tribe;\n    });\n  }\n  public like(hero: string, villain: string) {\n    this.setRelationship(\n      hero,\n      villain,\n      true,\n      \"likedBy\",\n      \"dislikedBy\",\n      \"relationships\"\n    );\n  }\n  public dislike(hero: string, villain: string) {\n    this.setRelationship(\n      hero,\n      villain,\n      false,\n      \"likedBy\",\n      \"dislikedBy\",\n      \"relationships\"\n    );\n  }\n  public neutral(hero: string, villain: string) {\n    this.setRelationship(\n      hero,\n      villain,\n      undefined,\n      \"likedBy\",\n      \"dislikedBy\",\n      \"relationships\"\n    );\n  }\n  public friends(hero: string, villain: string) {\n    this.like(hero, villain);\n    this.like(villain, hero);\n  }\n  public threat(h: string, v: string) {\n    this.setRelationship(\n      h,\n      v,\n      true,\n      \"thinksImThreat\",\n      \"thinksImWeak\",\n      \"powerRankings\"\n    );\n  }\n  public weak(h: string, v: string) {\n    this.setRelationship(\n      h,\n      v,\n      false,\n      \"thinksImThreat\",\n      \"thinksImWeak\",\n      \"powerRankings\"\n    );\n  }\n  public utr(h: string, v: string) {\n    this.setRelationship(\n      h,\n      v,\n      undefined,\n      \"thinksImThreat\",\n      \"thinksImWeak\",\n      \"powerRankings\"\n    );\n  }\n  public alliance(members: string[]) {\n    for (let i = 0; i < members.length; i++) {\n      for (let j = i + 1; j < members.length; j++) {\n        this.friends(members[i], members[j]);\n      }\n    }\n  }\n  public enemies(hero: string, villain: string) {\n    this.dislike(hero, villain);\n    this.dislike(villain, hero);\n  }\n}\n","import {\n  PortraitProps,\n  HouseguestPortrait,\n  PortraitState,\n} from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport {\n  selectedPlayer$,\n  displayMode$,\n  getSelectedPlayer,\n  selectedTribe$,\n} from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { isNullOrUndefined } from \"util\";\nimport {\n  classifyRelationship,\n  RelationshipTypeToPopularity,\n} from \"../../utils/ai/classifyRelationship\";\nimport { tribeId, Tribe } from \"../../images/tribe\";\nimport _ from \"lodash\";\nimport {\n  calculatePopularity,\n  calculatePowerRanking,\n} from \"../../images/RelationshipMapper\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n  private subs: Subscription[] = [];\n  private view: HouseguestPortrait;\n  constructor(view: HouseguestPortrait) {\n    this.view = view;\n  }\n  get defaultState(): PortraitState {\n    return {\n      popularity: this.view.props.popularity,\n      displayMode: displayMode$.value,\n      powerRanking: this.view.props.powerRanking,\n      disabled: !!this.view.props.disabled,\n      likedBy: this.view.props.likedBy,\n      dislikedBy: this.view.props.dislikedBy,\n      thinksImThreat: this.view.props.thinksImThreat,\n      thinksImWeak: this.view.props.thinksImWeak,\n    };\n  }\n  public backgroundColor(\n    props: PortraitProps,\n    state: PortraitState\n  ): undefined | string {\n    const selectedPlayer = getSelectedPlayer();\n    if (state.disabled) return undefined;\n    if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n      return selectedColor.toHex();\n    }\n    return props.isEvicted || state.disabled\n      ? undefined\n      : this.view.state.displayMode.backgroundColor(this.view.state);\n  }\n\n  public subscribe() {\n    const subs: Subscription[] = [];\n    subs.push(\n      selectedPlayer$.subscribe({\n        next: this.refreshData,\n      })\n    );\n    subs.push(\n      selectedTribe$.subscribe({\n        next: this.refreshTribeFilter,\n      })\n    );\n    subs.push(\n      displayMode$.subscribe({\n        next: (displayMode) => this.view.setState({ displayMode }),\n      })\n    );\n    this.subs = subs;\n  }\n\n  public unsubscribe() {\n    this.subs.forEach((sub) => sub.unsubscribe());\n  }\n\n  private refreshTribeFilter = (selectedTribe: Tribe) => {\n    // un-disable all\n    if (!selectedTribe.name) {\n      this.refreshData(getSelectedPlayer());\n      return;\n    }\n    // o/w, disable if nessecary\n    const selectedPlayer = getSelectedPlayer();\n    this.updateLikeCounts(selectedTribe);\n    if (\n      tribeId(selectedTribe) !== tribeId(this.view.props.tribe) &&\n      selectedPlayer !== null &&\n      selectedPlayer.id === this.view.props.id\n    ) {\n      selectedPlayer$.next(null);\n    }\n  };\n\n  // this effectively restricts likeCounts to [people on the same tribe as me]\n  // this function can later be repurposed into accepting a more generic filter, such as a group in general\n  private updateLikeCounts(selectedTribe: Tribe) {\n    const props = this.view.props;\n    const disabled = tribeId(selectedTribe) !== tribeId(props.tribe);\n    const newState: any = {\n      disabled,\n    };\n    const f = hasSameTribe(tribeId(props.tribe));\n    newState.likedBy = _.filter(props.likedBy, f);\n    newState.dislikedBy = _.filter(props.dislikedBy, f);\n    newState.thinksImThreat = _.filter(props.thinksImThreat, f);\n    newState.thinksImWeak = _.filter(props.thinksImWeak, f);\n    if (!getSelectedPlayer() && !disabled) {\n      const n = props.tribe ? props.tribe.size : 0;\n      newState.popularity = calculatePopularity({ ...newState }, n);\n      newState.powerRanking = calculatePowerRanking({ ...newState }, n);\n    }\n    this.view.setState(newState);\n  }\n\n  private goToDefaultState() {\n    if (this.view.state.disabled) return;\n    if (tribeId(selectedTribe$.value)) {\n      this.updateLikeCounts(selectedTribe$.value);\n    } else {\n      this.view.setState(this.defaultState);\n    }\n  }\n\n  private refreshData = (data: SelectedPlayerData | null) => {\n    if (this.view.state.disabled) return;\n    if (!data) {\n      this.goToDefaultState();\n    } else {\n      if (data.id !== this.view.props.id) {\n        this.view.setState({\n          popularity: getPopularity(\n            this.view.props.relationships![data.id],\n            data.relationships[this.view.props.id!]\n          ),\n          powerRanking: getPowerRanking(\n            this.view.props.powerRankings![data.id],\n            data.powerRankings[this.view.props.id!]\n          ),\n        });\n      } else {\n        // note; popularity = 2 means the player is currently selected.\n        this.view.setState({\n          popularity: 2,\n          powerRanking: 2,\n        });\n      }\n    }\n  };\n}\ntype Rship = number | boolean | undefined;\n\nfunction getPowerRanking(hero: Rship, villain: Rship): number | undefined {\n  if (typeof hero === \"number\") {\n    return hero;\n  } else if (typeof villain === \"number\") {\n    return villain;\n  }\n  if (hero === true) return 1;\n  if (hero === false) return 0;\n  return undefined;\n}\n\nfunction getPopularity(hero: Rship, villain: Rship): number | undefined {\n  if (isNullOrUndefined(hero) && isNullOrUndefined(villain)) return undefined;\n\n  if (typeof hero === \"number\") {\n    return hero;\n  } else if (typeof villain === \"number\") {\n    return villain;\n  }\n\n  const relationshipType = classifyRelationship(0, 0, hero, villain);\n  return RelationshipTypeToPopularity[relationshipType];\n}\n\ninterface Like {\n  tribeId: string;\n  groups: Set<number>;\n}\n\nconst hasSameTribe = (tribe: string): ((l: Like) => boolean) => {\n  return (x: { tribeId: string; groups: Set<number> }): boolean => {\n    return tribe === x.tribeId;\n  };\n};\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNullOrUndefined } from \"util\";\nimport { RelationshipMap, DiscreteRelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Tribe } from \"../../images/tribe\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Likemap } from \"../../utils/likeMap\";\n\nconst Subtitle = styled.small`\n  font-weight: 100;\n  font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n  margin: 5px;\n  border: 1px solid\n    ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n  color: black;\n  border-radius: 5px;\n  text-align: center;\n  font-weight: 600;\n  max-width: 7rem;\n  word-wrap: break-word;\n  -webkit-transition-property: none;\n  -moz-transition-property: none;\n  -o-transition-property: none;\n  transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n  font-weight: 100;\n  color: grey;\n  background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n  font-weight: 100;\n  color: #c3ae88;\n  background-color: #5d5340;\n  filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n  min-width: 100px;\n  max-width: 110px;\n  width: -moz-available; /* For Mozzila */\n  width: -webkit-fill-available; /* For Chrome */\n`;\n\nconst Grayscale = styled(Normal)`\n  filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n  filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n  imageURL: string;\n  name: string;\n  id?: number;\n  relationships?: RelationshipMap | DiscreteRelationshipMap;\n  popularity?: number;\n  powerRankings: DiscreteRelationshipMap;\n  powerRanking?: number;\n  isEvicted?: boolean;\n  disabled?: boolean;\n  deltaPopularity?: number;\n  detailed?: boolean;\n  superiors?: Set<number>;\n  //\n  likedBy: Likemap;\n  dislikedBy: Likemap;\n  thinksImWeak: Likemap;\n  thinksImThreat: Likemap;\n  tribe?: Tribe;\n}\n\nexport interface PortraitState {\n  popularity?: number;\n  powerRanking?: number;\n  displayMode: PortraitDisplayMode;\n  disabled: boolean;\n  likedBy: Likemap;\n  dislikedBy: Likemap;\n  thinksImWeak: Likemap;\n  thinksImThreat: Likemap;\n}\nexport class HouseguestPortrait extends React.Component<\n  PortraitProps,\n  PortraitState\n> {\n  private controller: HouseguestPortraitController;\n\n  public constructor(props: PortraitProps) {\n    super(props);\n    this.controller = new HouseguestPortraitController(this);\n    this.state = this.controller.defaultState;\n  }\n\n  public componentDidMount() {\n    if (isNullOrUndefined(this.props.id)) {\n      return;\n    }\n    this.controller.subscribe();\n  }\n\n  public componentWillUnmount() {\n    this.controller.unsubscribe();\n  }\n\n  private onClick(): void {\n    if (\n      isNullOrUndefined(this.props.id) ||\n      !this.props.relationships ||\n      this.state.disabled ||\n      this.props.isEvicted\n    ) {\n      return;\n    }\n    const data = {\n      id: this.props.id,\n      relationships: this.props.relationships,\n      isEvicted: !!this.props.isEvicted,\n      popularity: this.props.popularity || 0,\n      superiors: this.props.superiors,\n      powerRankings: this.props.powerRankings,\n    };\n    selectPlayer(data);\n  }\n\n  public render() {\n    const props = this.props;\n    const state = this.state;\n    const Img = getImageClass(props, state);\n    let subtitle: any[] = [];\n    subtitle = this.state.displayMode.generateSubtitle(\n      props,\n      state,\n      !!props.detailed\n    );\n\n    let Portrait = MemoryWallPortrait;\n    if (state.disabled) {\n      Portrait = Jury;\n    } else if (props.isEvicted) {\n      Portrait = Evicted;\n    }\n    return (\n      <Portrait\n        onClick={() => this.onClick()}\n        style={{\n          backgroundColor: this.controller.backgroundColor(props, this.state),\n        }}\n      >\n        <Img src={props.imageURL} style={{ height: 100 }} />\n        <br />\n        {props.name}\n        <br />\n        <Subtitle>{subtitle}</Subtitle>\n      </Portrait>\n    );\n  }\n}\n\nfunction getImageClass(props: PortraitProps, state: PortraitState) {\n  let imageClass = props.isEvicted ? Grayscale : Normal;\n  imageClass = state.disabled ? Sepia : imageClass;\n  return imageClass;\n}\n","import { RelationshipMap, DiscreteRelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n  id: number;\n  popularity: number;\n  relationships: RelationshipMap | DiscreteRelationshipMap;\n  powerRankings: DiscreteRelationshipMap;\n  isEvicted: boolean;\n  superiors?: Set<number>;\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n  if (\n    !player ||\n    (getSelectedPlayer() && getSelectedPlayer()!.id === player.id)\n  ) {\n    selectedPlayer$.next(null);\n  } else {\n    selectedPlayer$.next(player);\n  }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n  box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n    theme.name === \"light\"\n      ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\"\n      : \"\"};\n  border-radius: 6px;\n  margin-left: 3px;\n  margin-right: 3px;\n  margin-bottom: 5px;\n  padding-bottom: 10px;\n  padding-top: 1px;\n  background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n  margin-left: 3px;\n  margin-right: 3px;\n  margin-bottom: 3px;\n  background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n  return (\n    <ShadowBox className={props.className || \"\"} style={props.style || {}}>\n      {props.children}\n    </ShadowBox>\n  );\n}\n\nexport function Box(props: any): JSX.Element {\n  return (\n    <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n      {props.children}\n    </StyledBox>\n  );\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: ProfileHouseguest[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest) => {\n        let result;\n        if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest.tooltip) {\n            result = <Tooltip text={houseguest.tooltip}>{result}</Tooltip>;\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { DividerBox } from \"../layout/box\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { ProfileHouseguest } from \".\";\nimport styled from \"styled-components\";\nimport { textColor } from \"../../model/color\";\nimport { selectTribe } from \"./selectedTribe\";\nimport { Subscription } from \"rxjs\";\nimport { selectedTribe$ } from \"../../subjects/subjects\";\nimport { Tribe, tribeId } from \"../../images/tribe\";\n\ninterface TribeContainerProps {\n  hgs: ProfileHouseguest[];\n  tribe: Tribe;\n}\n\ninterface TribeContainerState {\n  selected: boolean;\n}\n\nexport class TribeContainer extends React.Component<\n  TribeContainerProps,\n  TribeContainerState\n> {\n  private subs: Subscription[] = [];\n\n  public constructor(props: TribeContainerProps) {\n    super(props);\n    this.state = { selected: false };\n  }\n  public componentDidMount() {\n    this.subs.push(\n      selectedTribe$.subscribe((selected) => {\n        this.setState({\n          selected: tribeId(selected) === tribeId(this.props.tribe),\n        });\n      })\n    );\n  }\n\n  public componentWillUnmount() {\n    this.subs.forEach((sub) => sub.unsubscribe());\n  }\n  private select() {\n    selectTribe(this.props.tribe);\n  }\n\n  public render() {\n    const Hoverable = this.getHoverable(this.props.tribe.color);\n    const tribeName = this.props.tribe.name;\n    return (\n      <DividerBox key={tribeName} style={{ textAlign: \"center\" }}>\n        {tribeName !== \"undefined\" && (\n          <p>\n            <Hoverable onClick={this.select.bind(this)}>{tribeName}</Hoverable>\n          </p>\n        )}\n        <Portraits houseguests={this.props.hgs} centered={true}></Portraits>\n      </DividerBox>\n    );\n  }\n  private getHoverable = (color: string) => {\n    const normal = `background-color: ; color: ${color};`;\n    const hilite = `background-color: ${color}; color: ${textColor(color)};`;\n    const selected = this.state.selected;\n    return styled.b`\n      :not(:hover) {\n        ${selected ? hilite : normal}\n      }\n      :hover {\n        ${hilite}\n      }\n    `;\n  };\n}\n","import { Tribe, tribeId, nullTribe } from \"../../images/tribe\";\nimport { selectedTribe$ } from \"../../subjects/subjects\";\n\nexport function selectTribe(t: Tribe) {\n  if (tribeId(t) === tribeId(selectedTribe$.value)) {\n    selectedTribe$.next(nullTribe);\n  } else selectedTribe$.next(t);\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { RelationshipMap, DiscreteRelationshipMap } from \"../../utils\";\nimport { Tribe, tribeId, nullTribe } from \"../../images/tribe\";\nimport _ from \"lodash\";\nimport { TribeContainer } from \"./tribeContainer\";\nimport { Likemap } from \"../../utils/likeMap\";\nexport interface IMemoryWallProps {\n  readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n  id?: number;\n  isEvicted?: boolean;\n  disabled?: boolean;\n  tribe?: Tribe;\n  //\n  relationships?: RelationshipMap | DiscreteRelationshipMap;\n  popularity?: number;\n  deltaPopularity?: number;\n  likedBy: Likemap;\n  dislikedBy: Likemap;\n  //\n  powerRankings: DiscreteRelationshipMap;\n  powerRanking?: number;\n  thinksImWeak: Likemap;\n  thinksImThreat: Likemap;\n  //\n  hohWins?: number;\n  povWins?: number;\n  nominations?: number;\n  tooltip?: string;\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n  const houseguests = props.houseguests;\n  if (!houseguests || houseguests.length === 0) {\n    return <div />;\n  }\n  const houseguestsByTribe = _.groupBy(houseguests, (hg) =>\n    hg.tribe === undefined ? hg.tribe : hg.tribe.name\n  );\n  const tribes: JSX.Element[] = [];\n  _.forEach(houseguestsByTribe, (hgs, name) => {\n    if (name === \"undefined\" && _.size(houseguestsByTribe) > 1) {\n      return;\n    }\n    const tribe: Tribe = hgs[0].tribe ? hgs[0].tribe : nullTribe;\n    tribes.push(<TribeContainer key={tribeId(tribe)} {...{ tribe, hgs }} />);\n  });\n  return (\n    <div\n      style={{\n        margin: \"auto\",\n        maxWidth: -1,\n      }}\n    >\n      {tribes}\n    </div>\n  );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport { roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n  RelationshipTypeToSymbol,\n  RelationshipType as Relationship,\n  classifyRelationship,\n  ThreatLevelToSymbol,\n  ThreatLevel,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\nimport { sizeOf } from \"../../utils/likeMap\";\n\nfunction threatLevelOf(a: boolean | undefined): string {\n  if (a === undefined) return \"-\";\n  if (a) return \"💢 THREAT\";\n  return \"💤 WEAK\";\n}\n\nfunction emptySubtitle(): JSX.Element[] {\n  return [<br key={1} />, <br key={2} />];\n}\n\nexport function generatePowerSubtitle(\n  hero: PortraitProps,\n  state: PortraitState,\n  _: boolean | undefined\n): any[] {\n  if (state.disabled) return emptySubtitle();\n  let key = 0;\n  let subtitle: any[] = [];\n  key = addPopularityLine(state, hero, !!_, subtitle, key);\n  key = addCompsLine(hero, subtitle, key);\n  if (!hero.isEvicted) {\n    const data = getSelectedPlayer() as SelectedPlayerData | null;\n    if (data && data.id !== hero.id) {\n      subtitle.push(\n        <div key={key++}>{`${threatLevelOf(hero.powerRankings[data.id])}`}</div>\n      );\n    } else if (data && data.id === hero.id) {\n      subtitle.push(<div key={key++}>I'M SEEN AS</div>);\n      subtitle.push(<div key={key++}>{threatLevelCountTitle(state)}</div>);\n    } else {\n      subtitle.push(<div key={key++}>{threatLevelCountTitle(state)}</div>);\n    }\n  } else {\n    subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n  }\n  return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n  hero: PortraitProps,\n  state: PortraitState,\n  detailed: boolean = false\n): any[] {\n  if (state.disabled) return emptySubtitle();\n  // const data = getSelectedPlayer() as SelectedPlayerData | null;\n  let key = 0;\n  let subtitle: any[] = [];\n  // popularity\n  // key = addPopularityLine(state, hero, detailed, subtitle, key);\n  // competition wins\n  key = addCompsLine(hero, subtitle, key);\n  // friendship count / relationship classification titles\n  ({ subtitle, key } = addCountTitle(\n    hero,\n    state,\n    subtitle,\n    key,\n    friendOrEnemyTitle,\n    friendEnemyCountTitle\n  ));\n  // if (!data) subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n  return subtitle;\n}\n\nfunction addCountTitle(\n  hero: PortraitProps,\n  state: PortraitState,\n  subtitle: any[],\n  key: number,\n  discreteTitle: (a: PortraitProps, b: SelectedPlayerData) => string[],\n  countTitle: (a: PortraitState) => string[]\n) {\n  if (!hero.isEvicted) {\n    const data = getSelectedPlayer() as SelectedPlayerData | null;\n    if (data && data.id !== hero.id) {\n      const titles = discreteTitle(hero, data);\n      subtitle = subtitle.concat(\n        titles.map((txt) => <div key={key++}>{txt}</div>)\n      );\n    } else {\n      const titles = countTitle(state);\n      subtitle = subtitle.concat(\n        titles.map((txt) => <div key={key++}>{txt}</div>)\n      );\n    }\n  } else {\n    subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n  }\n  return { subtitle, key };\n}\n\nfunction addPopularityLine(\n  state: { popularity?: number },\n  hero: PortraitProps,\n  detailed: boolean,\n  subtitle: any[],\n  key: number\n) {\n  let popularity = state.popularity;\n  if (popularity && (popularity > 1 || popularity < -1)) {\n    popularity = hero.popularity;\n  }\n  if (popularity && !hero.isEvicted) {\n    let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n    const deltaPop = getDeltaPopularity(hero, popularity);\n    if (detailed && deltaPop !== 0) {\n      const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n      popularitySubtitle += `${arrow} ${deltaPop}%`;\n    }\n    subtitle.push(<div key={key++}>{\"\"}</div>); // hardcoded to do nothing for the discrete case.\n  }\n  return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n  if (compWins(hero)) {\n    subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n  } else {\n    subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n  }\n  return key;\n}\n\nfunction getDeltaPopularity(\n  houseguest: PortraitProps,\n  statePopularity: number\n) {\n  if (\n    roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)\n  ) {\n    return 0;\n  }\n  return houseguest.deltaPopularity\n    ? roundTwoDigits(houseguest.deltaPopularity)\n    : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n  return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n    houseguest.povWins && houseguest.hohWins\n      ? `|🛇 ${houseguest.povWins}`\n      : houseguest.povWins\n      ? `🛇 ${houseguest.povWins}`\n      : \"\"\n  }${\n    (houseguest.hohWins || houseguest.povWins) && houseguest.nominations\n      ? \"|\"\n      : \"\"\n  }${houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"}`;\n}\n\nfunction friendOrEnemyTitle(\n  hero: PortraitProps,\n  villain: SelectedPlayerData\n): string[] {\n  const titles: string[] = [];\n  const heroRelationship: boolean | number | undefined = hero.relationships![\n    villain.id\n  ];\n  const villainRelationship: boolean | number | undefined =\n    villain.relationships[hero.id!];\n  titles.push(\n    RelationshipTypeToSymbol[\n      classifyRelationship(\n        hero.popularity || 0,\n        villain.popularity,\n        heroRelationship,\n        villainRelationship\n      )\n    ]\n  );\n  return titles;\n}\n\nfunction threatLevelCountTitle(hero: PortraitState): string[] {\n  const titles: string[] = [];\n  const count = {\n    friends: sizeOf(hero.thinksImThreat),\n    enemies: sizeOf(hero.thinksImWeak),\n  };\n  const friendCountText =\n    count.friends > 0\n      ? `${count.friends} ${ThreatLevelToSymbol[ThreatLevel.Threat]}`\n      : \"\";\n\n  const enemyCountText =\n    count.enemies > 0\n      ? `${count.enemies} ${ThreatLevelToSymbol[ThreatLevel.Weak]}`\n      : \"\";\n\n  titles.push(\n    `${friendCountText}${\n      friendCountText && enemyCountText && \" | \"\n    }${enemyCountText}`\n  );\n  return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitState): string[] {\n  const titles: string[] = [];\n  const count = {\n    friends: sizeOf(hero.likedBy),\n    enemies: sizeOf(hero.dislikedBy),\n  };\n  const friendCountText =\n    count.friends > 0\n      ? `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}`\n      : \"\";\n\n  const enemyCountText =\n    count.enemies > 0\n      ? `${count.enemies} ${RelationshipTypeToSymbol[Relationship.Enemy]}`\n      : \"\";\n\n  titles.push(\n    `${friendCountText}${\n      friendCountText && enemyCountText && \" | \"\n    }${enemyCountText}`\n  );\n  return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport {\n  generatePopularitySubtitle,\n  generatePowerSubtitle,\n} from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n  minColor: Rgb;\n  maxColor: Rgb;\n  backgroundColor: (state: PortraitState) => string;\n  generateSubtitle: (\n    props: PortraitProps,\n    state: PortraitState,\n    detailed?: boolean\n  ) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n  minColor: popularityMinColor,\n  maxColor: popularityMaxColor,\n  backgroundColor: (state: PortraitState) => {\n    const popularity = state.popularity;\n    if (popularity === undefined) {\n      return \"rgb(170, 170, 170)\";\n    }\n\n    const extremePopularity = extremeValues(popularity);\n    const percent = (extremePopularity + 1) / 2;\n    return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n  },\n  generateSubtitle: generatePopularitySubtitle,\n};\n\nconst powerMinColor = new Rgb(192, 181, 255);\nconst powerMaxColor = new Rgb(255, 204, 94);\n/// originals ^^^^^\n// const powerMinColor = new Rgb(104, 128, 158); // blue\n\n// const powerMinColor = new Rgb(148, 16, 240);\n// const powerMaxColor = new Rgb(255, 143, 0);\n\nexport const powerMode: PortraitDisplayMode = {\n  minColor: powerMinColor,\n  maxColor: powerMaxColor,\n  backgroundColor: (state: PortraitState) => {\n    const powerRanking = state.powerRanking;\n    if (powerRanking === undefined) return \"rgb(170, 170, 170)\";\n    return interpolateColor(powerMinColor, powerMaxColor, powerRanking);\n  },\n  generateSubtitle: generatePowerSubtitle,\n};\n","import React from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { Box } from \"../layout/box\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ViewsBox = styled(Box)`\n  background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nexport function ViewsBar() {\n  return (\n    <ViewsBox className=\"level is-mobile\" key=\"viewsbar\">\n      <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n      <ViewBarTag mode={powerMode} text={\"Threat Level\"}></ViewBarTag>\n      {/* <ViewBarTag mode={powerMode} disabled={true} text={\"Cliques [Coming Soon™]\"}></ViewBarTag> */}\n    </ViewsBox>\n  );\n}\n","import React from \"react\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { HasText } from \"../layout/text\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\nimport { ProfileHouseguest } from \"../memoryWall/memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { players$ } from \"../../subjects/subjects\";\n\ninterface PregameScreenState {\n  cast: ProfileHouseguest[];\n}\n\nexport class MemoryWallScreen extends React.Component<{}, PregameScreenState> {\n  private subs: Subscription[] = [];\n  public constructor(props: never) {\n    super(props);\n    this.state = { cast: players$.value };\n  }\n\n  public componentDidMount() {\n    this.subs.push(\n      players$.subscribe((cast) => {\n        this.setState({ cast });\n      })\n    );\n  }\n\n  public componentWillUnmount() {\n    this.subs.forEach((sub) => sub.unsubscribe());\n  }\n\n  public render() {\n    if (this.state.cast.length === 0) {\n      return <HasText>Cast is empty.</HasText>;\n    }\n    return (\n      <HasText>\n        <ViewsBar />\n        <MemoryWall houseguests={this.state.cast} />\n      </HasText>\n    );\n  }\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { MemoryWallScreen } from \"../components/memoryWallScreen/memoryWallScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport {\n  PortraitDisplayMode,\n  popularityMode,\n} from \"../model/portraitDisplayMode\";\nimport { ColorTheme } from \"../theme/theme\";\nimport { ProfileHouseguest } from \"../components/memoryWall\";\nimport { Tribe, nullTribe } from \"../images/tribe\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<MemoryWallScreen />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n  episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n  switchEpisode$.next(n);\n}\n\nexport const selectedTribe$ = new BehaviorSubject<Tribe>(nullTribe);\n\nexport const players$ = new BehaviorSubject<ProfileHouseguest[]>([]);\n\n// this variable is unused but if you delete it it breaks some race condition or something and the code compiles, but doesn't work anymore.\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\n\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(\n  null\n);\nexport function getSelectedPlayer() {\n  return selectedPlayer$.value;\n}\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(\n  popularityMode\n);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\nexport const theme$ = new Subject<ColorTheme>();\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n  private rng: prand.RandomGenerator;\n\n  public randomFloat(): number {\n    let result: number;\n    [result, this.rng] = this.rng.next();\n    return result / 2147483647.0;\n  }\n\n  public randomInt(a: number, b: number): number {\n    let result: number;\n    [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n    return result;\n  }\n\n  public flipCoin(): boolean {\n    let result: number;\n    [result, this.rng] = this.rng.next();\n    return result % 2 === 0;\n  }\n\n  public seed(seed: number) {\n    this.rng = prand.xorshift128plus(seed);\n  }\n\n  public constructor(seed: number) {\n    this.rng = prand.xorshift128plus(seed);\n  }\n}\n\nexport function rng() {\n  return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\n// theoretically this does nothing, but if you delete it the code stops working.\n// yay race conditions...?\nconst castSub = cast$.subscribe({\n  next: () => {},\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n  return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n  const excludedIds = exclusions.map((hg) => hg.id);\n  return inclusions.filter(\n    (hg) => !excludedIds.includes(hg.id) && !hg.isEvicted\n  );\n}\n\nexport function randomPlayer(\n  inclusions: Houseguest[],\n  exclusions: Houseguest[] = []\n): Houseguest {\n  if (inclusions.length === 0) {\n    throw new Error(\"Tried to get a random player from a list of 0 players.\");\n  }\n  const options = exclude(inclusions, exclusions);\n  const choice = rng().randomInt(0, options.length - 1);\n\n  return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState) {\n  return gameState.houseguests.filter((hg) => !hg.isEvicted);\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n  return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n  return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\n// export function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n//     let sum = 0;\n//     let count = 0;\n//     const targetId = hero.id;\n//     house.forEach(houseguest => {\n//         if (houseguest.id !== targetId) {\n//             count++;\n//             sum += houseguest.relationships[targetId];\n//         }\n//     });\n//     return count === 0 ? 0 : sum / count;\n// }\n\nexport class GameState {\n  // Current state of the game after a phase.\n\n  readonly houseguestCache: { [id: number]: Houseguest } = {};\n  readonly houseguests: Houseguest[] = [];\n  readonly remainingPlayers: number = 0;\n  readonly phase: number = 0;\n  readonly previousHOH?: Houseguest;\n  readonly log: EpisodeLog[] = [];\n  get currentLog() {\n    return this.log[this.phase];\n  }\n\n  public constructor(init: PlayerProfile[] | GameState) {\n    if (!(init instanceof Array)) {\n      Object.assign(this, init);\n    } else {\n      const profiles = init as PlayerProfile[];\n      this.remainingPlayers = profiles.length;\n      profiles.forEach((profile, i) => {\n        const hg: Houseguest = new Houseguest({\n          ...profile,\n          id: i,\n          relationships: newRelationshipMap(profiles.length, i),\n        });\n        this.houseguestCache[i] = hg;\n        this.houseguests.push(hg);\n      });\n    }\n  }\n}\n\nexport class MutableGameState {\n  public houseguests: Houseguest[] = [];\n  public houseguestCache: { [id: number]: Houseguest } = {};\n  public remainingPlayers: number = 0;\n  public phase: number = 0;\n  public previousHOH?: Houseguest;\n  public log: EpisodeLog[] = [];\n  get currentLog() {\n    return this.log[this.phase];\n  }\n\n  public constructor(init: GameState | MutableGameState) {\n    const copy = _.cloneDeep(init);\n    Object.assign(this, copy);\n  }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import {\n  GameState,\n  MutableGameState,\n  nonEvictedHouseguests,\n} from \"../../model/gameState\";\nimport { Episode } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\n\nexport class EpisodeFactory {\n  public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n    let newState = new MutableGameState(gameState);\n    newState.phase++;\n    if (nonEvictedHouseguests(gameState).length > 2) {\n      newState.log[newState.phase] = new EpisodeLog();\n    }\n    throw new Error(\"You can't call this function.\");\n  }\n}\n","import {\n  MutableGameState,\n  getById,\n  inJury,\n  nonEvictedHouseguests,\n  GameState,\n  EpisodeType,\n  Episode,\n  InitEpisode,\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { Scene } from \"./scene\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n  canPlayWith: (n: number) => {\n    return n > 1;\n  },\n  eliminates: 1,\n  arrowsEnabled: true,\n  hasViewsbar: true,\n};\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n  const evictee = getById(gameState, id);\n  if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n  evictee.isEvicted = true;\n  if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n  }\n  if (inJury(gameState)) {\n    nonEvictedHouseguests(gameState).forEach((hg) => {\n      hg.superiors.delete(evictee.id);\n    });\n  }\n  gameState.remainingPlayers--;\n}\n\nexport function generateBbVanilla(initialGameState: GameState): null {\n  return null;\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n  readonly title: string;\n  readonly scenes: Scene[];\n  readonly content: JSX.Element;\n  readonly gameState: GameState;\n  readonly type = BigBrotherVanilla;\n\n  public constructor(init: InitEpisode) {\n    super(init);\n    this.title = init.title;\n    this.scenes = init.scenes;\n    this.content = init.content;\n    this.gameState = init.gameState;\n  }\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n  canPlayWith: (n: number) => n === 3,\n  eliminates: 2,\n  arrowsEnabled: true,\n  hasViewsbar: true,\n};\n\nexport function generateBbFinale(\n  initialGameState: GameState\n): BigBrotherFinaleEpisode {\n  const title = \"Finale\";\n  const content = (\n    <HasText>\n      Finale Night\n      <NextEpisodeButton />\n    </HasText>\n  );\n  const scenes: Scene[] = [];\n  return new BigBrotherFinaleEpisode({\n    gameState: initialGameState,\n    content,\n    title,\n    scenes,\n    type: BigBrotherFinale,\n  });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n  readonly title: string;\n  readonly scenes: Scene[];\n  readonly content: JSX.Element;\n  readonly gameState: GameState;\n  readonly type = BigBrotherFinale;\n\n  public constructor(init: InitEpisode) {\n    super(init);\n    this.title = init.title;\n    this.scenes = init.scenes;\n    this.content = init.content;\n    this.gameState = init.gameState;\n  }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n  noMargin?: boolean;\n  children?: any;\n  style?: any;\n  noTheme?: boolean;\n}\n\nconst NoMargin = styled.div`\n  text-align: center;\n  color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n  text-align: center;\n  color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n  if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n  return <Center style={props.style}>{props.children} </Center>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n  return (\n    <Centered {...props}>\n      <b style={props.style || {}}>{props.children} </b>\n    </Centered>\n  );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n  return (\n    <Centered noMargin={props.noMargin}>\n      <i>{props.children} </i>\n    </Centered>\n  );\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport {\n  VoteType,\n  WinnerVote,\n  RunnerUpVote,\n} from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\n\nexport const EndgameTableCell = styled.td`\n  padding: 0.1em 0.4em;\n  border: 1px solid\n    ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n  border: 1px solid\n    ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n  border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) =>\n    theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n  background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n  height: 0.4em;\n  background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n  const masterLog: EpisodeLog[] = gameState.log;\n  const houseguestCells: JSX.Element[][] = [];\n  gameState.houseguests.forEach((hg, i) => {\n    houseguestCells[hg.id] = [\n      <Gray key={`hg-name---${i}`}>\n        <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n      </Gray>,\n    ];\n  });\n  const evictionOrder: number[] = [];\n  const topRowCells: JSX.Element[] = [];\n  const preVetoCells: JSX.Element[] = [];\n  const vetoCells: JSX.Element[] = [];\n  const postVetoCells: JSX.Element[] = [];\n  const evictedCells: JSX.Element[] = [];\n  const winnerCells: JSX.Element[] = [];\n  masterLog.forEach((log, i) => {\n    generateTopRow(log, i, topRowCells, masterLog.length - 1);\n    generatePreVetoRow(log, i, preVetoCells);\n    generateVetoRow(log, i, vetoCells);\n    generatePostVetoRow(log, i, postVetoCells);\n    generateEvictedRow(log, i, evictedCells, gameState);\n    if (!log) return;\n    evictionOrder.push(log.evicted);\n    if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n    if (log.winner !== undefined) evictionOrder.push(log.winner);\n    // add each of the votes to the houseguest cells\n    for (const [key, value] of Object.entries(log.votes)) {\n      // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n      const id: number = (key as unknown) as number;\n      const vote: VoteType = value;\n      houseguestCells[id].push(vote.render(gameState));\n    }\n    if (log.winner !== undefined && log.runnerUp !== undefined) {\n      houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n      houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n      evictedCells.push(\n        <RunnerUpCell>\n          <CenteredBold noMargin={true}>\n            {getById(gameState, log.runnerUp).name}\n          </CenteredBold>\n          <Centered noMargin={true}>\n            <small>Finalist</small>\n          </Centered>\n        </RunnerUpCell>\n      );\n      winnerCells.push(\n        <WinnerCell>\n          <CenteredBold noMargin={true}>\n            {getById(gameState, log.winner).name}\n          </CenteredBold>\n          <Centered noMargin={true}>\n            <small>Winner</small>\n          </Centered>\n        </WinnerCell>\n      );\n    }\n  });\n  preVetoCells.push(\n    <White key={`preveto--finale`} rowSpan={3}>\n      <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n    </White>\n  );\n  const winnerRow = <tr>{winnerCells}</tr>;\n  const topRow = <tr>{topRowCells}</tr>;\n  const preVetoRow = <tr>{preVetoCells}</tr>;\n  const vetoRow = <tr>{vetoCells}</tr>;\n  const postVetoRow = <tr>{postVetoCells}</tr>;\n  const blackRow = (\n    <BlackRow>\n      <td colSpan={gameState.houseguests.length} />\n    </BlackRow>\n  );\n  const houseguestRows: JSX.Element[] = [];\n  const evictedRow = <tr>{evictedCells}</tr>;\n  let evictionColSpan = -1;\n  const weeks = evictionOrder.length;\n  evictionOrder.reverse().forEach((id, i) => {\n    if (evictionColSpan > 0) {\n      const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n      const isJury = getById(gameState, id).isJury;\n      const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n      const evicted = (\n        <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n          <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n          <CenteredItallic noMargin={true}>\n            <small>{weekText}</small>\n          </CenteredItallic>\n        </Evicted>\n      );\n      if (!isJury) {\n        houseguestCells[id].push(evicted); // not jury, they dead\n      } else {\n        const tempList = houseguestCells[id].slice(0, -1);\n        tempList.push(evicted);\n        tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n        houseguestCells[id] = tempList;\n      }\n    }\n    houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n    evictionColSpan++;\n  });\n\n  return (\n    <div>\n      <FullscreenButton />\n      <EndgameTable>\n        <tbody>\n          {topRow}\n          {preVetoRow}\n          {vetoRow}\n          {postVetoRow}\n          {blackRow}\n          {houseguestRows}\n          {blackRow}\n          {evictedRow}\n          {winnerRow}\n        </tbody>\n      </EndgameTable>\n    </div>\n  );\n}\n\nfunction generateEvictedRow(\n  log: EpisodeLog | undefined,\n  i: number,\n  cells: JSX.Element[],\n  gameState: GameState\n) {\n  if (!log) {\n    cells.push(\n      <Gray key={i} rowSpan={2}>\n        <CenteredBold noMargin={true}>Evicted</CenteredBold>\n      </Gray>\n    );\n    return;\n  }\n\n  const voteTextLine1 =\n    log.soleVoter !== undefined ? `${log.soleVoter}'s choice` : \"\";\n\n  cells.push(\n    <Evicted key={i} rowSpan={2}>\n      <Centered noMargin={true}>\n        <b>{getById(gameState, log.evicted).name}</b>\n        <br />\n        <small>\n          {voteTextLine1} <br />\n          to evict\n        </small>\n      </Centered>\n    </Evicted>\n  );\n}\n\nfunction generatePostVetoRow(\n  log: EpisodeLog | undefined,\n  i: number,\n  cells: JSX.Element[]\n) {\n  if (!log) {\n    cells.push(\n      <Gray key={`postVeto--${i}`}>\n        <CenteredBold noMargin={true}>\n          Nominations\n          <br />\n          <small>(post-veto)</small>\n        </CenteredBold>\n      </Gray>\n    );\n    return;\n  }\n  cells.push(\n    <White key={`postVeto--${i}`}>\n      <Centered noMargin={true}>\n        {log.nominationsPostVeto[0]}\n        <br /> {log.nominationsPostVeto[1]}\n      </Centered>\n    </White>\n  );\n}\n\nfunction generateVetoRow(\n  log: EpisodeLog | undefined,\n  i: number,\n  cells: JSX.Element[]\n) {\n  if (!log) {\n    cells.push(\n      <Gray key={`veto--${i}`}>\n        <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n      </Gray>\n    );\n    return;\n  }\n  if (log.vetoWinner === undefined) return;\n\n  cells.push(\n    <White key={`veto--${i}`}>\n      <Centered noMargin={true}>{log.vetoWinner}</Centered>\n    </White>\n  );\n}\n\nfunction generatePreVetoRow(\n  log: EpisodeLog | undefined,\n  i: number,\n  cells: JSX.Element[]\n) {\n  if (!log) {\n    cells.push(\n      <Gray key={`preveto--${i}`}>\n        <CenteredBold noMargin={true}>\n          Nominations\n          <br />\n          <small>(pre-veto)</small>\n        </CenteredBold>\n      </Gray>\n    );\n    return;\n  }\n  if (log.nominationsPreVeto.length === 0) {\n    cells.push(\n      <White key={`preveto--${i}`} rowSpan={2}>\n        <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n      </White>\n    );\n    return;\n  }\n  cells.push(\n    <White key={`preveto--${i}`}>\n      <Centered noMargin={true}>\n        {log.nominationsPreVeto[0]}\n        <br /> {log.nominationsPreVeto[1]}\n      </Centered>\n    </White>\n  );\n}\n\nfunction generateTopRow(\n  log: EpisodeLog | undefined,\n  i: number,\n  cells: JSX.Element[],\n  max: number\n) {\n  if (!log) {\n    cells.push(<Gray key={`toprow--${i}`} />);\n    return;\n  }\n  if (i === max) {\n    cells.push(\n      <Gray key={`toprow--${i}`} colSpan={2}>\n        <CenteredBold noMargin={true}>Finale</CenteredBold>\n      </Gray>\n    );\n    return;\n  }\n  cells.push(\n    <Gray key={`toprow--${i}`}>\n      <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n    </Gray>\n  );\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { EpisodeType, Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function finalJurySize() {\n  return jurors;\n}\n\nlet jurors = 7;\n\nexport function getFinalists() {\n  return 2;\n}\n\nexport class Season {\n  private factory: EpisodeFactory;\n\n  public constructor() {\n    this.factory = new EpisodeFactory();\n  }\n\n  // In the future, this would all be customizable,\n  // and not just all big brother episodes by default.\n\n  public renderEpisode(gameState: GameState, type: EpisodeType): Episode {\n    return this.factory.nextEpisode(gameState, type);\n  }\n\n  public whichEpisodeType(players: number) {\n    if (players === 3) {\n      return BigBrotherFinale;\n    }\n    if (players === 2) {\n      return GameOver;\n    }\n    return BigBrotherVanilla;\n  }\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n  mainContentStream$,\n  episodes$,\n  switchEpisode$,\n  newEpisode,\n  switchSceneRelative,\n  getSelectedPlayer,\n  selectedPlayer$,\n} from \"../../subjects/subjects\";\n\ninterface IndexedScene {\n  scene: Scene;\n  index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n  private view: Sidebar;\n  private subscriptions: Subscription[] = [];\n  private season: Season = new Season();\n  private scenes: IndexedScene[] = [];\n  private selectedEpisode: number = 0;\n\n  public constructor(view: Sidebar) {\n    this.view = view;\n    this.subscriptions.push(\n      episodes$.subscribe({\n        next: (episode) => this.onNewEpisode(episode),\n      })\n    );\n    this.subscriptions.push(\n      switchEpisode$.subscribe({\n        next: (value: number) => {\n          this.switchSceneRelative(value);\n        },\n      })\n    );\n  }\n\n  public getSelectedEpisode() {\n    return this.selectedEpisode;\n  }\n\n  public async switchToScene(id: number) {\n    mainContentStream$.next(this.scenes[id].scene.render);\n    this.selectedEpisode = this.scenes[id].index;\n    await this.view.setState({ selectedScene: id });\n    if (getSelectedPlayer() !== null) {\n      selectedPlayer$.next(\n        getById(\n          this.scenes[this.view.state.selectedScene].scene.gameState,\n          getSelectedPlayer()!.id\n        )\n      );\n    }\n  }\n\n  private switchSceneRelative = (delta: number) => {\n    const selectedScene = this.view.state.selectedScene;\n    const renderedScenes = this.scenes.length;\n    const targetScene = selectedScene + delta;\n    if (targetScene < 0) {\n      return;\n    }\n    const lastEpisode = this.view.state.episodes[\n      this.view.state.episodes.length - 1\n    ];\n    if (targetScene < renderedScenes) {\n      // Go back to an earlier scene\n      this.switchToScene(targetScene);\n    } else if (targetScene === renderedScenes) {\n      // Generate a new scene, then jump to it\n      const currentGameState = lastEpisode.gameState;\n      const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState)\n        .length;\n      const nextEpisodeType = this.season.whichEpisodeType(newPlayerCount);\n      if (newPlayerCount > 0) {\n        newEpisode(\n          this.season.renderEpisode(currentGameState, nextEpisodeType)\n        );\n        this.switchSceneRelative(1);\n      }\n    }\n  };\n\n  get handleKeyDown(): (e: any) => void {\n    return this._handleKeyDown.bind(this);\n  }\n\n  private _handleKeyDown(event: any) {\n    const state = this.view.state;\n\n    if (\n      state.episodes[this.selectedEpisode] === undefined ||\n      !state.episodes[this.selectedEpisode].type.arrowsEnabled\n    ) {\n      return;\n    }\n    if (event.keyCode === LEFT) {\n      switchSceneRelative(-1);\n    } else if (event.keyCode === RIGHT) {\n      switchSceneRelative(1);\n    }\n  }\n\n  private onNewEpisode(episode: Episode | null) {\n    if (!episode) {\n      this.view.setState({ episodes: [], selectedScene: 0 });\n      this.scenes = [];\n    } else {\n      const newState = { ...this.view.state };\n      // starts at -1: prevent OBOE\n      const latestIndex =\n        this.scenes.length === 0\n          ? -1\n          : this.scenes[this.scenes.length - 1].index;\n      const index = latestIndex + 1;\n      this.scenes.push({ scene: episode, index });\n      episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n      newState.episodes.push(episode);\n      this.view.setState(newState);\n    }\n  }\n\n  public destroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\ninterface SidebarState {\n  episodes: Episode[];\n  selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n  private controller: SidebarController;\n  public constructor(props: {}) {\n    super(props);\n    this.controller = new SidebarController(this);\n    this.state = { episodes: [], selectedScene: 0 };\n  }\n\n  public componentDidMount() {\n    document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n  }\n\n  public componentWillUnmount() {\n    this.controller.destroy();\n  }\n\n  public render() {\n    return (\n      <Box style={{ minWidth: 180, display: \"none\" }}>\n        <HasText>{this.getEpisodes()}</HasText>\n      </Box>\n    );\n  }\n\n  private getHighlight(title: string, key: number) {\n    if (key === this.state.selectedScene) {\n      return <mark>{title}</mark>;\n    }\n    return title;\n  }\n\n  private getEpisodes() {\n    const result: JSX.Element[] = [];\n    // Weird OBOE to make keys start at 0\n    let episodeKey = -1;\n    let breakKey = 0;\n    this.state.episodes.forEach((episode: Episode) => {\n      const id = ++episodeKey;\n      result.push(\n        <b\n          key={id}\n          onClick={() => {\n            this.controller.switchToScene(id);\n          }}\n        >\n          {this.getHighlight(episode.title, id)}\n        </b>\n      );\n      result.push(<br key={--breakKey} />);\n      episode.scenes.forEach((scene: Scene) => {\n        const id = ++episodeKey;\n        if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n          result.push(\n            <a key={id} onClick={() => this.controller.switchToScene(id)}>\n              {this.getHighlight(scene.title, id)}\n            </a>\n          );\n          result.push(<br key={--breakKey} />);\n        }\n      });\n    });\n    return result;\n  }\n}\n","export const Base64 = (function () {\n  var digitsStr =\n    \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+-\";\n  var digits = digitsStr.split(\"\");\n  var digitsMap: Map<string, number> = new Map<string, number>();\n  for (var i = 0; i < digits.length; i++) {\n    digitsMap.set(digits[i], i);\n  }\n  return {\n    fromInt: function (int32: number) {\n      var result = \"\";\n      while (true) {\n        result = digits[int32 & 0x3f] + result;\n        int32 >>>= 6;\n        if (int32 === 0) break;\n      }\n      return result;\n    },\n    toInt: function (digitsStr: string) {\n      var result = 0;\n      var digits = digitsStr.split(\"\");\n      for (var i = 0; i < digits.length; i++) {\n        const m = digitsMap.get(digits[i]);\n        if (m === undefined)\n          throw new Error(\"Tried to decode an invalid B64 string\");\n        result = (result << 6) + m;\n      }\n      return result;\n    },\n  };\n})();\n","import {\n  RelationshipMapper,\n  RelationshipHouseguest,\n} from \"./RelationshipMapper\";\nimport { CodedRelationships } from \"./encoder\";\nimport { Base64 } from \"../utils/base64\";\nimport _ from \"lodash\";\n\nexport function decodeToRelationshipMapper(\n  m: RelationshipMapper,\n  c1: string\n): RelationshipMapper | null {\n  const r = new RelationshipMapper(_.cloneDeep(m.houseguests));\n  r.reset();\n  const c = c1.trim();\n  try {\n    if (c.split(\"|\").length !== 4) throw new Error(`Not a code`);\n    const [tribes, evictees, relationships, powerRankings] = c.split(\"|\");\n    if (\n      relationships.length % 2 > 0 ||\n      evictees.length % 2 > 0 ||\n      powerRankings.length % 2 > 0\n    )\n      throw new Error(\n        `Misaligned bytes: (${evictees.length}, ${relationships.length}, ${powerRankings.length}`\n      );\n    decodeEvictees(r, evictees);\n    decodeTribes(r, tribes);\n    decodeRelationships(r, { relationships, powerRankings });\n  } catch (e) {\n    alert(e);\n    return null;\n  }\n  return r;\n}\n\nconst decode = (s: string) => Base64.toInt(s).toString(3).padStart(7, \"0\"); // base64 --> ternary\n\nconst ternaryToRelationship = new Map<string, boolean | undefined>(\n  Object.entries({\n    \"0\": false,\n    \"1\": true,\n    \"2\": undefined,\n  })\n);\nfunction fromTernary(n: string): boolean | undefined {\n  const result = ternaryToRelationship.get(n);\n  if (result === undefined && n !== \"2\")\n    throw new Error(`${n} is not a ternary value`);\n  return result;\n}\nconst chex = /([a-f0-9]){6}/;\n\nfunction decodeTribes(m: RelationshipMapper, c: string) {\n  const tribes: string[] = c.split(\"=\");\n  tribes.forEach((t) => {\n    const hash = t.indexOf(\"#\");\n    if (hash === -1) throw new Error(\"Invalid tribe, does not have a color\");\n    const tribeName = t.slice(0, hash);\n    const color = t.slice(hash + 1, hash + 7);\n    const members = t.slice(hash + 7);\n    if (!chex.test(color)) throw new Error(`Invalid color: ${color}`);\n    const tribemates: string[] = [];\n    let i = 0;\n    while (members[2 * i] !== undefined) {\n      tribemates.push(\n        codeToHouseguest(m, `${members[2 * i]}${members[2 * i + 1]}`, \"tribes\")\n          .name\n      );\n      i++;\n    }\n    m.tribe({ color: `#${color}`, name: tribeName }, tribemates);\n  });\n}\n\nfunction codeToHouseguest(\n  m: RelationshipMapper,\n  c: string,\n  e?: string\n): RelationshipHouseguest {\n  const lookedUp: number = Base64.toInt(c);\n  if (lookedUp >= m.houseguests.length)\n    throw new Error(\n      `${lookedUp} (${c}) exceeds the maximum id: ${m.houseguests.length} in ${e}`\n    );\n  return m.houseguests[lookedUp];\n}\n\nfunction decodeEvictees(m: RelationshipMapper, c: string) {\n  let i = 0;\n  while (c[2 * i] !== undefined) {\n    m.evict(codeToHouseguest(m, `${c[2 * i]}${c[2 * i + 1]}`, \"evictees\").name);\n    i++;\n  }\n}\n\nfunction decodeRelationships(m: RelationshipMapper, c: CodedRelationships) {\n  let decodedR = \"\";\n  let decodedP = \"\";\n  let r: number = 0;\n  let p: number = 0;\n  const [relationships, powerRankings] = [c.relationships, c.powerRankings];\n  m.houseguests.forEach((hg) => {\n    if (hg.isEvicted || hg.disabled) return;\n    m.nonEvictedIDs.forEach((id) => {\n      if (hg.id === id) return;\n      //////////////////////////////////////////////// relationships\n      if (decodedR.length === 0) {\n        decodedR = decode(`${relationships[r]}${relationships[r + 1]}`);\n        r += 2;\n      }\n      m.setRelationship(\n        hg.name,\n        m.houseguests[id].name,\n        fromTernary(decodedR[0]),\n        \"likedBy\",\n        \"dislikedBy\",\n        \"relationships\"\n      );\n      decodedR = decodedR.slice(1);\n      //////////////////////////////////////////////// powerRankings\n      if (decodedP.length === 0) {\n        decodedP = decode(`${powerRankings[p]}${powerRankings[p + 1]}`);\n        p += 2;\n      }\n      m.setRelationship(\n        hg.name,\n        m.houseguests[id].name,\n        fromTernary(decodedP[0]),\n        \"thinksImThreat\",\n        \"thinksImWeak\",\n        \"powerRankings\"\n      );\n      decodedP = decodedP.slice(1);\n    });\n  });\n}\n","import { Topbar } from \"./topBar\";\nimport { decodeToRelationshipMapper } from \"../../images/decoder\";\nimport { RelationshipMapper } from \"../../images/RelationshipMapper\";\nimport {\n  players$,\n  selectedPlayer$,\n  selectedTribe$,\n} from \"../../subjects/subjects\";\nimport { nullTribe } from \"../../images/tribe\";\n\nexport class TopbarController {\n  private view: Topbar;\n  public constructor(view: Topbar) {\n    this.view = view;\n  }\n  public onSubmit = () => {\n    if (!this.view.state.inputCode) return;\n    const newMap: RelationshipMapper | null = decodeToRelationshipMapper(\n      this.view.state.rMapper,\n      this.view.state.inputCode\n    );\n    this.view.setState({ inputCode: \"\" });\n    if (newMap === null) return;\n\n    this.view.setState({ rMapper: newMap });\n    players$.next(newMap.houseguests);\n    selectedPlayer$.next(null);\n    selectedTribe$.next(nullTribe);\n  };\n}\n","import { RelationshipMapper } from \"./RelationshipMapper\";\nimport _ from \"lodash\";\nimport { Base64 } from \"../utils/base64\";\n\nexport type CodedRelationships = {\n  relationships: string;\n  powerRankings: string;\n};\nconst decode = (s: string) => Base64.toInt(s).toString(3).padStart(7, \"0\"); // base64 --> ternary\nconst encode = (s: string) => encodeNumber(parseInt(s, 3)).padStart(2, \"0\"); // ternary --> base64\n\n// 0 : left child   : false\n// 1 : middle child : true\n// 2 : right child  : undefined\nfunction toTernary(r: boolean | undefined): string {\n  if (r === undefined) return \"2\";\n  if (r === true) return \"1\";\n  return \"0\";\n}\n\nfunction encodeNumber(n: number): string {\n  return Base64.fromInt(n).padStart(2, \"0\"); // don't remove the padStart, idiot\n}\n\nfunction encodeEvictees(m: RelationshipMapper): string {\n  let result = \"\";\n  m.houseguests.forEach((hg) => {\n    if (!hg.isEvicted) return;\n    if (encodeNumber(hg.id) === undefined) {\n      throw new Error(`Invalid houseguest ID: ${hg.id}`);\n    }\n    result += encodeNumber(hg.id);\n  });\n  return result;\n}\n\nfunction encodeTribes(m: RelationshipMapper): string {\n  const houseguestsByTribe = _.groupBy(m.houseguests, (hg) =>\n    hg.tribe === undefined ? hg.tribe : hg.tribe.name\n  );\n  let encodedTribes: string = \"\";\n  _.forEach(houseguestsByTribe, (hgs, tribeName) => {\n    if (tribeName === \"undefined\") return;\n    const color = hgs[0].tribe ? hgs[0].tribe.color : \"#ffffff\";\n    let ids = \"\";\n    hgs.forEach((hg) => {\n      ids += encodeNumber(hg.id);\n    });\n    const spacer = encodedTribes !== \"\" ? \"=\" : \"\";\n    encodedTribes += `${spacer}${tribeName}${color}${ids}`;\n  });\n  return encodedTribes;\n}\n\nfunction encodeRelationships(m: RelationshipMapper): CodedRelationships {\n  let relationships = \"\";\n  let powerRankings = \"\";\n  let rBuffer: string = \"\";\n  let pBuffer: string = \"\";\n  let validateBuffer = (s: string) => {\n    if (decode(encode(s)) !== s) {\n      throw new Error(\n        `encoding failure: ${s} (${encode(s)}) encoded to \n        ${decode(encode(s))} `\n      );\n    }\n  };\n  m.houseguests.forEach((hg) => {\n    if (hg.isEvicted || hg.disabled) return; // we skip evicted houseguests\n    m.nonEvictedIDs.forEach((id) => {\n      if (id === hg.id) return; // we don't declare relationships for ourselves\n      ///// relationships\n      const nextCharR = toTernary(hg.relationships[id]);\n      rBuffer += nextCharR;\n      if (rBuffer.length === 7) {\n        const e: string = encode(rBuffer);\n        if (e.length !== 2)\n          throw new Error(`Byte misalignment prevented: (${e})`);\n        validateBuffer(rBuffer);\n        relationships += e;\n        rBuffer = \"\";\n      }\n      /// powerRankings /////////////////////////////////////////\n\n      const nextCharP = toTernary(hg.powerRankings[id]);\n      pBuffer += nextCharP;\n      if (pBuffer.length === 7) {\n        const e: string = encode(pBuffer);\n        if (e.length !== 2)\n          throw new Error(`Byte misalignment prevented: (${e})`);\n        validateBuffer(pBuffer);\n        powerRankings += e;\n        pBuffer = \"\";\n      }\n    });\n  });\n  if (rBuffer !== \"\") {\n    rBuffer = rBuffer.padEnd(7, \"0\");\n    validateBuffer(rBuffer);\n    relationships += encode(rBuffer);\n  }\n  if (pBuffer !== \"\") {\n    pBuffer = pBuffer.padEnd(7, \"0\");\n    validateBuffer(pBuffer);\n    powerRankings += encode(pBuffer);\n  }\n  return { relationships, powerRankings };\n}\n\nexport function encodeRelationshipMapper(m: RelationshipMapper): string {\n  const r = encodeRelationships(m);\n  return `${encodeTribes(m)}|${encodeEvictees(m)}|${r.relationships}|${\n    r.powerRankings\n  }`;\n}\n","import { newDiscreteRelationshipMap, hashcode } from \"../utils\";\nimport prand from \"pure-rand\";\nimport {\n  RelationshipMapper,\n  RelationshipHouseguest,\n} from \"./RelationshipMapper\";\nimport { encodeRelationshipMapper } from \"./encoder\";\n\nconst master_kohga = \"master kohga\";\nconst revali = \"revali\";\nconst teebo = \"teebo\";\nconst kass = \"kass\";\nconst link = \"link\";\nconst chio = \"chio\";\nconst roscoe = \"roscoe\";\nconst riju = \"riju\";\nconst magda = \"magda\";\nconst robbie = \"robbie\";\nfunction importAll(\n  context: __WebpackModuleApi.RequireContext\n): RelationshipMapper {\n  const profiles: RelationshipHouseguest[] = [];\n  setupProfiles(context, profiles, new Set<string>(), new Set<string>());\n  const r: RelationshipMapper = new RelationshipMapper(profiles);\n  r.tribe({ name: \"Wisdom\", color: \"#635cb9\" }, [\n    \"ancient oven\",\n    \"epona\",\n    \"hunnie\",\n    \"karson\",\n    \"mipha\",\n    \"pelison\",\n    \"urbosa\",\n  ]);\n  r.tribe({ name: \"Power\", color: \"#c70134\" }, [\n    \"Kass\",\n    \"magda\",\n    \"master kohga\",\n    \"patrica\",\n    \"revali\",\n    \"roscoe\",\n    \"teebo\",\n  ]);\n  r.tribe({ name: \"Courage\", color: \"#7d8d4e\" }, [\n    \"Link\",\n    \"chio\",\n    \"oaki\",\n    \"prince sidon\",\n    \"royal white horse\",\n    \"robbie\",\n    \"riju\",\n  ]);\n  const like = r.like;\n  r.dislike(\"magda\", \"patrica\");\n  r.dislike(\"magda\", \"roscoe\");\n  r.dislike(\"magda\", \"kass\");\n  like(\"magda\", \"revali\"); // said top ally\n  like(\"epona\", \"hunnie\");\n  like(\"epona\", \"urbosa\");\n  like(\"epona\", \"pelison\");\n  r.dislike(\"epona\", \"ancient oven\");\n  r.like(master_kohga, revali);\n  r.like(master_kohga, kass);\n  r.dislike(master_kohga, teebo);\n  r.friends(chio, link);\n  r.like(chio, riju);\n  r.dislike(chio, robbie);\n  r.threat(teebo, roscoe);\n  r.like(magda, master_kohga); //  from master's POV\n  r.dislike(master_kohga, roscoe);\n\n  console.log(encodeRelationshipMapper(r));\n  return r;\n}\n\n////////////////// safe space below here\n\nexport const initialProfiles = importAll(\n  require.context(\"./src\", false, /.jpg/)\n);\n\nfunction setupProfiles(\n  context: __WebpackModuleApi.RequireContext,\n  profiles: RelationshipHouseguest[],\n  evictedHouseguests: Set<string>,\n  jurors: Set<string>\n) {\n  context.keys().map((item: string, i: number) => {\n    const name = item.replace(\".jpg\", \"\").replace(\"./\", \"\");\n    profiles.push({\n      name,\n      imageURL: context(item),\n      id: i,\n      isEvicted: evictedHouseguests.has(name.toLowerCase()),\n      disabled: jurors.has(name.toLowerCase()),\n      relationships: newDiscreteRelationshipMap(context.length - 1, i),\n      powerRankings: newDiscreteRelationshipMap(context.length - 1, i),\n      likedBy: {},\n      dislikedBy: {},\n      thinksImThreat: {},\n      thinksImWeak: {},\n    });\n  });\n}\n\nfunction randomInt(\n  a: number,\n  b: number,\n  rng: prand.RandomGenerator\n): [number, prand.RandomGenerator] {\n  let result: number;\n  [result, rng] = prand.uniformIntDistribution(a, b, rng);\n  return [result, rng];\n}\nfunction randomChoice(\n  a: (number | boolean | undefined)[],\n  rng: prand.RandomGenerator\n): [number | boolean | undefined, prand.RandomGenerator] {\n  const [result, rng2] = randomInt(0, a.length - 1, rng);\n  return [a[result], rng2];\n}\n\nfunction randomRelationships(r: RelationshipMapper) {\n  let castNames = \"\";\n  r.houseguests.forEach((houseguest) => (castNames += houseguest.name));\n  let rng = prand.xorshift128plus(hashcode(castNames));\n  const hgs = r.houseguests;\n  for (let i = 0; i < hgs.length; i++) {\n    const hero = hgs[i].name;\n    for (let j = i + 1; j < hgs.length; j++) {\n      const villain = hgs[j].name;\n      let r1;\n      let r2;\n      [r1, rng] = randomChoice([true, false, undefined], rng);\n      [r2, rng] = randomChoice([true, false, undefined], rng);\n      r.setRelationship(\n        hero,\n        villain,\n        r1 as any,\n        \"likedBy\",\n        \"dislikedBy\",\n        \"relationships\"\n      );\n      r.setRelationship(\n        villain,\n        hero,\n        r2 as any,\n        \"likedBy\",\n        \"dislikedBy\",\n        \"relationships\"\n      );\n      [r1, rng] = randomChoice([true, false, undefined], rng);\n      [r2, rng] = randomChoice([true, false, undefined], rng);\n      r.setRelationship(\n        hero,\n        villain,\n        r1 as any,\n        \"thinksImThreat\",\n        \"thinksImWeak\",\n        \"powerRankings\"\n      );\n      r.setRelationship(\n        villain,\n        hero,\n        r2 as any,\n        \"thinksImThreat\",\n        \"thinksImWeak\",\n        \"powerRankings\"\n      );\n    }\n  }\n}\n","import React from \"react\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\nimport { TopbarController } from \"./topBarController\";\nimport { RelationshipMapper } from \"../../images/RelationshipMapper\";\nimport { initialProfiles } from \"../../images/initialProfiles\";\nimport { players$ } from \"../../subjects/subjects\";\n\ninterface TopbarProps {\n  style?: any;\n}\ninterface TopbarState {\n  inputCode: string;\n  rMapper: RelationshipMapper;\n}\nexport class Topbar extends React.Component<TopbarProps, TopbarState> {\n  private controller: TopbarController;\n\n  public constructor(props: TopbarProps) {\n    super(props);\n    this.controller = new TopbarController(this);\n    this.state = { inputCode: \"\", rMapper: initialProfiles };\n  }\n\n  public componentDidMount() {\n    players$.next(this.state.rMapper.houseguests);\n  }\n  private handleChange = ((event: { target: { value: string } }) => {\n    this.setState({ inputCode: event.target.value });\n  }).bind(this);\n\n  public render(): JSX.Element {\n    const style = { ...{ marginTop: 30 }, ...(this.props.style || {}) };\n    return (\n      <Box className=\"level is-mobile\" style={style}>\n        <HasText className=\"level-item\">\n          Enter Code:\n          <input\n            className=\"input\"\n            value={this.state.inputCode}\n            onChange={this.handleChange}\n          />\n          <button\n            disabled={!!!this.state.inputCode}\n            className={`button is-light`}\n            onClick={this.controller.onSubmit}\n          >\n            Submit\n          </button>\n        </HasText>\n      </Box>\n    );\n  }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n  controller: MainPageController;\n}\n\ninterface MainPageState {\n  fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n  public constructor(props: MainPageProps) {\n    super(props);\n    this.state = { fullscreen: false };\n    props.controller.inject(this);\n  }\n  public componentDidMount() {\n    this.props.controller.subscribe();\n  }\n  public componentWillUnmount() {\n    this.props.controller.unsubscribe();\n  }\n\n  public render() {\n    const fullscreen = this.state.fullscreen;\n    const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n    const wrapperStyle = fullscreen\n      ? { margin: \"auto\" }\n      : { margin: \"auto\", maxWidth: 1380, overflow: \"hidden\" };\n    return (\n      <div style={wrapperStyle}>\n        <Sidebar />\n        <Topbar style={hideOnFullscreen} />\n        <div className=\"columns\">\n          <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n            <MainContentArea />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    gradient: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\nexport const lightTheme: ColorTheme = {\n    name: \"light\",\n    bg: \"#fff\",\n    text: \"#363537\",\n    toggleBorder: \"#FFF\",\n    gradient: \"linear-gradient(#39598A, #79D7ED)\",\n    bodyArea: \"#fff\",\n    link: \"blue\",\n    mark: \"yellow\",\n    overlay: \"fff\",\n    evictedCell: \"#fa8072\",\n    grayCell: \"#eaecf0\",\n    lightGrayCell: \"#f8f9fa\",\n    winnerCell: \"#73fb76\",\n    runnerUpCell: \"#d1e8ef\",\n    nomineeCell: \"#959ffd\",\n    hohCell: \"#CCFFCC\",\n    portraitBorder: \"gray\",\n    tableCellBorder: \"#a2a9b1\",\n};\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    gradient: \"linear-gradient(#091236, #1E215D)\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n  div {\n    transition: all 0.25s linear;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n  private sub: Subscription | null = null;\n  public constructor(props: any) {\n    super(props);\n    this.state = {\n      theme: darkTheme,\n    };\n  }\n\n  public componentDidMount() {\n    this.sub = theme$.subscribe((theme) => {\n      this.setState({ theme });\n    });\n  }\n\n  public componentWillUnmount() {\n    if (this.sub) this.sub.unsubscribe();\n  }\n\n  render() {\n    return (\n      <ThemeProvider theme={this.state.theme}>\n        <>\n          <GlobalStyles />\n          <MainPage controller={new MainPageController()} />\n        </>\n      </ThemeProvider>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {});\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {});\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {});\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}